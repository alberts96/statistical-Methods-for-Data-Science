df<-df[!(df$ATECO10=="00"),]
table(df$`ATECO10`)
#ACTIVED OR FAILED
df$`active` = 0
df$`active`[df$`Legal status`== "Active"] = 1
df$`active`[df$`Legal status`== "Active (default of payments)"] = 1
df$`active`[df$`Legal status`== "Active (receivership)"] = 1
table(df$`active`)
table(df$`active`)
#Rename
df$'region' = df$'Registered office address - Region'
df$'year' = df$'Last acoounting closing date'
df$'ateco' = df$'ATECO10'
table(df$'Legal form')
df$`Legal form`[
df$'Legal form'!= "S.C.A.R.L." &
df$'Legal form'!= "S.C.A.R.L.P.A." &
df$'Legal form'!= "S.R.L. one-person" &
df$'Legal form'!= "S.R.L. simplified" &
df$'Legal form'!= "S.P.A." &
df$'Legal form'!= "S.R.L." &
df$'Legal form'!= "Social cooperative company" &
df$'Legal form'!= "S.N.C." &
df$'Legal form'!= "S.A.S."  &
df$'Legal form'!= "Consortium"] = 'Other'
table(df$'Legal form')
df = df[, c("Legal form", "active", "age", "region", "ATECO10", "size","year","Incorporation year")]
table(df$'region')
df = df[, c("Legal form", "active", "age", "region", "ATECO10", "size", "year","Incorporation year")]
dfAB = df[, c("Legal form", "active", "age", "region", "size", "year","Incorporation year")]
dfAB = df[, c("Legal form", "active", "age", "region")]
table(df$`size`)
df = df[, c("Legal form", "active", "age", "region", "ATECO10", "size","year","Incorporation year")]
dfAB = df[, c("Legal form", "active", "age", "region", "ATECO10", "size","year","Incorporation year")]
dfAB = df[, c("Legal form", "active", "age", "region","year","Incorporation year")]
dfAB = df[, c("Legal form", "active", "age","year","Incorporation year")]
dfAB = df[, c("Legal form", "active", "age","year")]
dfAB = df[, c("Legal form", "active", "age")]
df$'year' = df$'Last accounting closing date'
rownames(df) = df$`Tax code number` #set tax code as index
dfAB = df[, c("Legal form", "active", "age", "region", "ATECO10", "size", "year","Incorporation year")]
write.csv(dfAB,"dfAB.csv")
names(aida)
dfAB
View(dfAB)
dfAB
ggplot(dfAB, aes(x=dfAB$size, colour=dfAB$active)) + geom_density()
library(ggplot2)
ggplot2(dfAB, aes(x=dfAB$size, colour=dfAB$active)) + geom_density()
ggplot(dfAB, aes(x=dfAB$size, colour=dfAB$active)) + geom_density()
ggplot(dfAB, aes(x=dfAB$size, colour=dfAB$active)) + geom_density()
pacman::p_load(pacman, dplyr, GGally, ggplot2, ggthemes,
ggvis, httr, lubridate, pylotly, rio, rmarkdown, shiny,
stringr, tidyr)
ggplot(dfAB, aes(x=dfAB$size, colour=dfAB$active)) + geom_density()
ggplot2(dfAB, aes(x=dfAB$size, colour=dfAB$active)) + geom_density()
ggplot2(dfAB, aes(x=dfAB$size, colour=dfAB$active)) + geom_density()
ggplot2(dfAB, aes(x=dfAB$size, colour=dfAB$active))
ggplot2(dfAB, aes(x=dfAB$size, colour=dfAB$active))
ggplot(data, aes(x = rating, fill = type)) +
geom_density(alpha = .3)
ggplot(dfAB, aes(x = dfAB$size, fill = dfAB$active)) +
geom_density(alpha = .3)
ggplot2(dfAB, aes(x = dfAB$size, fill = dfAB$active)) +
geom_density(alpha = .3)
library(ggplot2)
ggplot2(dfAB, aes(x = dfAB$size, fill = dfAB$active)) +
geom_density(alpha = .3)
ggplot(dfAB, aes(x = dfAB$size, fill = dfAB$active)) +
geom_density(alpha = .3)
library(ggplot2)
library(ggplot2)
library(hrbrthemes)
library(dplyr)
library(tidyr)
library(viridis)
p2 <- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
library(hrbrthemes)
pacman::p_load(pacman, dplyr, hrbrthemes, GGally, ggplot2, ggthemes,
ggvis, httr, lubridate, pylotly, rio, rmarkdown, shiny,
stringr, tidyr)
pacman::p_load( dplyr, hrbrthemes, GGally, ggplot2, ggthemes,
ggvis, httr, lubridate, pylotly, rio, rmarkdown, shiny,
stringr, tidyr)
pacman::p_load( pacman, dplyr, hrbrthemes, GGally, ggplot2, ggthemes,
ggvis, httr, lubridate, pylotly, rio, rmarkdown, shiny,
stringr, tidyr)
install.packages("pacman")
pacman::p_load( pacman, dplyr, hrbrthemes, GGally, ggplot2, ggthemes,
ggvis, httr, lubridate, pylotly, rio, rmarkdown, shiny,
stringr, tidyr)
ggplot2(dfAB, aes(x=dfAB$size, colour=dfAB$active))
ggplot(dfAB, aes(x=dfAB$size, colour=dfAB$active))
ggplot(dfAB, aes(x = dfAB$size, fill = dfAB$active)) +
geom_density(alpha = .3)
p2 <- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
p2
View(p2)
p2 <- ggplot(data=dfAB, aes(x=szie, group=active, fill=active)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
p2 <- ggplot(data=dfAB, aes(x=szie, group=active, fill=active)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
p2
p2 <- ggplot(data=dfAB, aes(x=size, group=active, fill=active)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
p2
p2 <- ggplot(data=dfAB, aes(x=size, group=active colour=active)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
p2
dfAB$'status' = 'failed'
dfAB[dfAB$active==1]$status = 'active'
dfAB$status[active==1] = 'active'
dfAB$status[dfAB$active==1,] = 'active'
dfAB$status[dfAB$active==1] = 'active'
p2 <- ggplot(data=dfAB, aes(x=size, group=active colour=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
p2 <- ggplot(data=dfAB, aes(x=size, group=status colour=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
ggplot(data=dfAB, aes(x=size, group=status colour=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
table(dfAB$'status')
ggplot(data=dfAB, aes(x=size, group=status colour=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
ggplot(data=dfAB, aes(x=size, group=status colour=status))
p2 <- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
p2 <- ggplot(data=dfAB, aes(x=size, group=status, fill=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum()
p2
p2 <- ggplot(data=dfAB, aes(x=size, group=status, fill=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum() + facet_wrap(~'Legal form') +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
axis.ticks.x=element_blank()
)
p2
p2 <- ggplot(data=dfAB, aes(x=size, group=status, fill=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum() + facet_wrap('Legal form') +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
axis.ticks.x=element_blank()
)
p2 <- ggplot(data=dfAB, aes(x=size, group=status, fill=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum() + facet_wrap('Legal form') +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
axis.ticks.x=element_blank()
)
p2 <- ggplot(data=dfAB, aes(x=size, group=status, fill=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum() + facet_wrap("Legal form") +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
axis.ticks.x=element_blank()
)
p2 <- ggplot(data=dfAB, aes(x=size, group=status, fill=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme_ipsum() + facet_wrap(status) +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
axis.ticks.x=element_blank()
)
p2 <- ggplot(data=dfAB, aes(x=size, group=status, fill=status)) +
geom_density(adjust=1.5, alpha=.4) +
theme(
legend.position="none",
theme_ipsum() + facet_wrap(~status) +
panel.spacing = unit(0.1, "lines"),
axis.ticks.x=element_blank()
)
p2 <- ggplot(data=dfAB, aes(x=size, group=status, fill=status)) +
geom_density(adjust=1.5, alpha=.4)
p2
ggplot(dfAB, aes(fill=status,  x=size)) +
geom_bar(position="dodge", stat="identity")
table(dfAB$status,dfAB$size)
rep(c("normal" , "stress" , "Nitrogen") , 4)
data <- data.frame(
type = c( rep("variable 1", 1000), rep("variable 2", 1000) ),
value = c( rnorm(1000), rnorm(1000, mean=4) )
)
View(data)
p <- data %>%
ggplot( aes(x=value, fill=type)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_ipsum() +
labs(fill="")
p
rm(data)
rm(p, p2)
ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_ipsum() +
labs(fill="")
ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red", "green")) +
theme_ipsum() +
labs(fill="")
ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red", "green"))
ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.3, position = 'identity') +
scale_fill_manual(values=c("red", "green"))
ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.3) +
scale_fill_manual(values=c("red", "green"))
ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red", "green")) +
theme_ipsum() +
labs(fill="")
data = as.data.frame.matrix(table(dfAB$status,dfAB$size))
View(data)
ggplot(data, aes(fill=status, y=c(0:4), x=c(0:4))) +
geom_bar(position="dodge", stat="identity")
barplot(height = data_base,                       # Grouped barplot using Base R
beside = TRUE)
barplot(height = data,                       # Grouped barplot using Base R
beside = TRUE)
barplot(height = data,                       # Grouped barplot using Base R
beside = TRUE)
barplot(height =  as.matrix(data),                       # Grouped barplot using Base R
beside = TRUE)
ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red", "green")) +
theme_ipsum() +
labs(fill="") +
geom_bar(stat = "identity",
position = "dodge")
ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red", "green")) +
ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red", "green")) +
ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red", "green"))
p<-ggplot(dfAB, aes(x=size, fill=status)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red", "green"))
p
data$1
data$failed
View(p)
rm(p)
g +geom_col(aes((x=size, fill=status, position = 'identity')) a) +
+
theme(legend.position = "top")
g +geom_col(aes((x=size, fill=status, position = 'identity')) a) +
theme(legend.position = "top")+
scale_fill_manual(values=c("red", "green"))
g +geom_col(aes((x=size, fill=status, position = 'identity')) a) +
scale_fill_manual(values=c("red", "green")) +
theme(legend.position = "top")
g +geom_col(aes((x=size, fill=status, position = 'identity')) a) +
scale_fill_manual(values=c("red", "green"))
g +geom_col(aes((x=size, fill=status, position = 'identity')) a)
counts <- table(dfAB$status,dfAB$size)
barplot(counts, main="Active and failed for year 2020",
xlab="Number of Gears", col=c("darkgreen","darkred"),
legend = rownames(counts), beside=TRUE)
barplot(counts, main="Active and failed for year 2020",
xlab="Size", col=c("darkgreen","darkred"),
legend = rownames(counts), beside=TRUE)
barplot(counts, main="Active and failed for year 2020",
xlab="Size", col=c("green","darkred"),
legend = rownames(counts), beside=TRUE)
barplot(counts, main="Active and failed for year 2020",
xlab="Size", col=c("green","red"),
legend = rownames(counts), beside=TRUE)
barplot(counts, main="Active and failed for year 2020",
xlab="Size", col=c("darkgreen","red"),
legend = rownames(counts), beside=TRUE)
barplot(counts, main="Active and failed for year 2020",
xlab="Size", col=c("limegreen","red3"),
legend = rownames(counts), beside=TRUE)
barplot(counts, main="Active and failed for year 2020",
xlab="Size", col=c("green3","red3"),
legend = rownames(counts), beside=TRUE)
table ?
margin.table(counts, failes)
margin.table(counts, failed)
margin.table(counts, 1)
margin.table(1,counts)
margin.table(counts,A)
margin.table(counts,2)
prop.table(counts)
prop.table(mytable, 1) # row percentages
prop.table(counts, 1) # row percentages
dist = prop.table(counts, 1) # row percentages
barplot(dist, main="Active and failed for year 2020",
xlab="Size", col=c("green3","red3"),
legend = rownames(counts), beside=TRUE)
year = 2010
df = dfAB
rm(dfAB)
dim(df[df%year==year])
dim(df[df%year==year])
dim(df[df$year==year])
dim(df[df$year==year,])
table(df$year)
year = 2018
dim(df[df$year==year,])
dfAB = df
df = df[df$year==year,]
dim(df)
barplot(prop.table(table(df$status,df$size), 1) , main="Active and failed for year 2020",
xlab="Size", col=c("green3","red3"),
legend = rownames(counts), beside=TRUE)
barplot(prop.table(table(df$status,df$size), 1) , main="Active and failed for year 2020",
xlab="Size", col=c("green3","red3"),
legend = rownames(counts), beside=TRUE)
dfA1 = df[dfAB$year==year,]
rm counts
rm(counts)
rm(dist)
View(aida)
View(data)
dfA1 = dfAB[dfAB$year==year,]
dfA1 <- dfAB[dfAB$year==year,]
dfA1$'Legal form'.unique()
dim(dfA1)
View(axis.ticks.x)
View(axis.ticks.x)
dfA1$'Legal form'.unique()
unique(dfA1$'Legal form')
for (form in unique(dfA1$'Legal form')){
print(form)
}
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,df$size), 1) , main="Active and failed for "+form+" in "+year,
xlab="Size", col=c("green3","red3"),
legend = rownames(counts), beside=TRUE)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,df$size), 1) , main="Active and failed for "+form+" in "+year,
xlab="Size", col=c("green3","red3"),
legend = rownames(table(dfA1$status,df$size)), beside=TRUE)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,df$size), 1) , main=str_c("Active and failed for",form,"in",year,sep=' '),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(dfA1$status,df$size)), beside=TRUE)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,df$size), 1) , main=str_c('Active and failed for "',form,'" in ",year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(dfA1$status,df$size)), beside=TRUE)
##recursively for each stat
for (form in unique(dfA1$'Legal form')){
jpeg("../img/A/1/LegalForm/"+form+".jpg", width = 350, height = "350")
df = dfA1[dfA1$`Legal form`==form,]
barplot(prop.table(table(df$status,df$size), 1) , main="Active and failed for "+form+" in "+year,
xlab="Size", col=c("green3","red3"),
legend = rownames(counts), beside=TRUE)
dev.off()
}
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,df$size), 1) , main=str_c('Active and failed for "',form,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(dfA1$status,df$size)), beside=TRUE)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,df$size), 1) , main=str_c('Active and failed for "',form,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(dfA1$status,df$size)), beside=TRUE)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,df$size), 1) , main=str_c('Active and failed for "',form,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(dfA1$status,df$size)), beside=TRUE)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,df$size), 1) , main=str_c('Active and failed for "',form,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(dfA1$status,dfA1$size)), beside=TRUE)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,dfA1$size), 1) , main=str_c('Active and failed for "',form,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(dfA1$status,dfA1$size)), beside=TRUE)
for (form in unique(dfA1$'Legal form')){
jpeg(str_c("../img/A/1/LegalForm/",form,".jpg"), width = 350, height = "350")
df = dfA1[dfA1$`Legal form`==form,]
barplot(prop.table(table(df$status,df$size), 1) , main=str_c('Active and failed for "',form,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(df$status,df$size)), beside=TRUE)
dev.off()
}
for (form in unique(dfA1$'Legal form')){
jpeg(str_c("../img/A/1/LegalForm/size/",form,".jpg"))
df = dfA1[dfA1$`Legal form`==form,]
barplot(prop.table(table(df$status,df$size), 1) , main=str_c('Active and failed for "',form,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(df$status,df$size)), beside=TRUE)
dev.off()
}
# Customizing the output
pdf("my_plot.pdf",         # File name
width = 8, height = 7, # Width and height in inches
bg = "white",          # Background color
colormodel = "cmyk"    # Color model (cmyk is required for most publications)
paper = "A4")          # Paper size
# Creating a plot
plot(rnorm(20))
# Closing the graphical device
dev.off()
# Customizing the output
pdf("my_plot.pdf",         # File name
width = 8, height = 7, # Width and height in inches
bg = "white",          # Background color
# Color model (cmyk is required for most publications)
paper = "A4")          # Paper size
# Creating a plot
plot(rnorm(20))
# Closing the graphical device
dev.off()
for (form in unique(dfA1$'Legal form')){
jpeg(str_c("img/A/1/LegalForm/size/",form,".jpg"))
df = dfA1[dfA1$`Legal form`==form,]
barplot(prop.table(table(df$status,df$size), 1) , main=str_c('Active and failed for "',form,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(df$status,df$size)), beside=TRUE)
dev.off()
}
for (ateco in unique(dfA1$ATECO10)){
jpeg(str_c("img/A/1/ATECO/size/",ateco,".jpg"))
df = dfA1[dfA1$`ATECO10`==ateco,]
barplot(prop.table(table(df$status,df$size), 1) , main=str_c('Active and failed for "',ateco,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(df$status,df$size)), beside=TRUE)
dev.off()
}
unique(dfA1$ATECO10)
for (ateco in unique(dfA1$ATECO10)){
jpeg(str_c("img/A/1/ATECO/size/",ateco,".jpg"))
df = dfA1[dfA1$`ATECO10`==ateco,]
barplot(prop.table(table(df$status,df$size), 1) , main=str_c('Active and failed for "',str_sub(ateco, 1, 3),'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(df$status,df$size)), beside=TRUE)
dev.off()
}
for (ateco in unique(dfA1$ATECO10)){
jpeg(str_c("img/A/1/ATECO/size/",str_sub(ateco, 1, 3),".jpg"))
df = dfA1[dfA1$`ATECO10`==ateco,]
barplot(prop.table(table(df$status,df$size), 1) , main=str_c('Active and failed for "',ateco,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(df$status,df$size)), beside=TRUE)
dev.off()
}
###################################
### Distribution for age  ###
###################################
library(sm)
pacman::p_load( pacman, sm, dplyr, hrbrthemes, GGally, ggplot2, ggthemes,
ggvis, httr, lubridate, pylotly, rio, rmarkdown, shiny,
stringr, tidyr)
pacman::p_load(  sm)
attach(mtcars)
attach(mtcars)
# plot densities
sm.density.compare(mpg, cyl, xlab="Miles Per Gallon")
attach(mtcars)
ggplot(dfA1, aes(x=age, fill=status)) +
geom_density(alpha=0.4)
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4)
p
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,dfA1$size), 1) , main=str_c('Active and failed for "',form,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(dfA1$status,dfA1$size)), beside=TRUE)
