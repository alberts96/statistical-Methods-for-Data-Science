}
unique(dfA1$ATECO10)
for (ateco in unique(dfA1$ATECO10)){
jpeg(str_c("img/A/1/ATECO/size/",ateco,".jpg"))
df = dfA1[dfA1$`ATECO10`==ateco,]
barplot(prop.table(table(df$status,df$size), 1) , main=str_c('Active and failed for "',str_sub(ateco, 1, 3),'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(df$status,df$size)), beside=TRUE)
dev.off()
}
for (ateco in unique(dfA1$ATECO10)){
jpeg(str_c("img/A/1/ATECO/size/",str_sub(ateco, 1, 3),".jpg"))
df = dfA1[dfA1$`ATECO10`==ateco,]
barplot(prop.table(table(df$status,df$size), 1) , main=str_c('Active and failed for "',ateco,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(df$status,df$size)), beside=TRUE)
dev.off()
}
###################################
### Distribution for age  ###
###################################
library(sm)
pacman::p_load( pacman, sm, dplyr, hrbrthemes, GGally, ggplot2, ggthemes,
ggvis, httr, lubridate, pylotly, rio, rmarkdown, shiny,
stringr, tidyr)
pacman::p_load(  sm)
attach(mtcars)
attach(mtcars)
# plot densities
sm.density.compare(mpg, cyl, xlab="Miles Per Gallon")
attach(mtcars)
ggplot(dfA1, aes(x=age, fill=status)) +
geom_density(alpha=0.4)
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4)
p
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA1$status,dfA1$size), 1) , main=str_c('Active and failed for "',form,'" in ',year),
xlab="Size", col=c("green3","red3"),
legend = rownames(table(dfA1$status,dfA1$size)), beside=TRUE)
p
for (form in unique(dfA1$'Legal form')){
jpeg(str_c("img/A/1/LegalForm/age/",form,".jpg"))
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',form,'" in ',year))
dev.off()
}
library(stringr)
for (form in unique(dfA1$'Legal form')){
jpeg(str_c("img/A/1/LegalForm/age/",form,".jpg"))
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',form,'" in ',year))
dev.off()
}
library(ggplot2)
for (form in unique(dfA1$'Legal form')){
jpeg(str_c("img/A/1/LegalForm/age/",form,".jpg"))
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',form,'" in ',year))
dev.off()
}
for (form in unique(dfA1$'Legal form')){
jpeg(str_c("img/A/1/LegalForm/age/",form,".jpg"))
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4)
#+    ggtitle(str_c('Active and failed for "',form,'" in ',year))
dev.off()
}
for (form in unique(dfA1$'Legal form')){
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4)
+    ggtitle(str_c('Active and failed for "',form,'" in ',year))
ggsave(str_c("img/A/1/LegalForm/age/",form,".jpg"))
}
for (form in unique(dfA1$'Legal form')){
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4)
+    ggtitle(str_c('Active and failed for "',form,'" in ',year))
ggsave(str_c("img/A/1/LegalForm/age/",form,".jpg"))
}
for (form in unique(dfA1$'Legal form')){
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4)
+ ggtitle(str_c('Active and failed for "',form,'" in ',year))
ggsave(str_c("img/A/1/LegalForm/age/",form,".jpg"))
}
for (form in unique(dfA1$'Legal form')){
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',form,'" in ',year))
ggsave(str_c("img/A/1/LegalForm/age/",form,".jpg"))
}
for (ateco in unique(dfA1$ATECO10)){
df = dfA1[dfA1$`ATECO10`==ateco]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',ateco,'" in ',year))
ggsave(str_c("img/A/1/LegalForm/age/",ateco,".jpg"))
}
for (ateco in unique(dfA1$ATECO10)){
df = dfA1[dfA1$`ATECO10`==ateco]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',ateco,'" in ',year))
ggsave(str_c("img/A/1/ATECO/age/",ateco,".jpg"))
}
for (ateco in unique(dfA1$ATECO10)){
df = dfA1[dfA1$`ATECO10`==ateco]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',ateco,'" in ',year))
ggsave(str_c("img/A/1/ATECO/age/",str_sub(ateco, 1, 3),".jpg"))
}
rlang::last_error()
for (ateco in unique(dfA1$ATECO10)){
df = dfA1[dfA1$`ATECO10`== ateco,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',ateco,'" in ',year))
ggsave(str_c("img/A/1/ATECO/age/",str_sub(ateco, 1, 3),".jpg"))
}
for (form in unique(dfA1$'Legal form')){
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',form,'" in ',year))
ggsave(str_c("img/A/1/LegalForm/age/",form,".jpg"))
}
dev.off()
for (form in unique(dfA1$'Legal form')){
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',form,'" in ',year))
ggsave(str_c("img/A/1/LegalForm/age/",form,".jpg"))
}
p<-ggplot(dfA1, aes(x=age, fill=status, color=c('green3','red3'))) + geom_density(alpha=0.4)
p
p<-ggplot(dfA1, aes(x=age, fill=status, colour=c('green3','red3'))) + geom_density(alpha=0.4)
p
p<-ggplot(dfA1, aes(x=age, fill=status, colour='cyl') + geom_density(alpha=0.4)
for (form in unique(dfA1$'Legal form')){
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',form,'" in ',year))
ggsave(str_c("img/A/1/LegalForm/age/",form,".jpg"))
}
p<-ggplot(dfA1, aes(x=age, fill=status, colour='cyl')) + geom_density(alpha=0.4)
p
p<-ggplot(dfA1, aes(x=age, fill=status, color='cyl')) + geom_density(alpha=0.4)
p
p<-ggplot(dfA1, aes(x=age, fill=status, color='cyl')) + geom_density(alpha=0.4)
p
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4)
p
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4) + scale_color_manual(values=c("green3", "red3"))
p
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4) + scale_fill_manual(values=c("green3", "red3"))
p
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4) + scale_fill_manual(values=c("green2", "red2"))
p
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4) + scale_fill_manual(values=c("green", "red"))
p
for (form in unique(dfA1$'Legal form')){
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',form,'" in ',year)) +
scale_fill_manual(values=c("green", "red"))
ggsave(str_c("img/A/1/LegalForm/age/",form,".jpg"))
}
for (ateco in unique(dfA1$ATECO10)){
df = dfA1[dfA1$`ATECO10`== ateco,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',ateco,'" in ',year))+
scale_fill_manual(values=c("green", "red"))
ggsave(str_c("img/A/1/ATECO/age/",str_sub(ateco, 1, 3),".jpg"))
}
gg_color_hue(1)
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4) + scale_fill_manual(values=c("#CAE00", "F8766D"))
p
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4) + scale_fill_manual(values=c("#7CAE00", "F8766D"))
p
for (form in unique(dfA1$'Legal form')){
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',form,'" in ',year)) +
scale_fill_manual(values=c("#CAE00", "F8766D"))
ggsave(str_c("img/A/1/LegalForm/age/",form,".jpg"))
}
ggplotColours(3)
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4) + scale_fill_manual(values=c("#7CAE00", "#F8766D"))
p
p<-ggplot(dfA1, aes(x=age, fill=status)) + geom_density(alpha=0.4) + scale_fill_manual(values=c("#04bc3c", "#fc746c"))
p
for (ateco in unique(dfA1$ATECO10)){
df = dfA1[dfA1$`ATECO10`== ateco,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',ateco,'" in ',year))+
scale_fill_manual(values=c("#04bc3c", "#fc746c"))
ggsave(str_c("img/A/1/ATECO/age/",str_sub(ateco, 1, 3),".jpg"))
}
for (form in unique(dfA1$'Legal form')){
df = dfA1[dfA1$`Legal form`==form,]
ggplot(df, aes(x=age, fill=status)) + geom_density(alpha=0.4) +
ggtitle(str_c('Active and failed for "',form,'" in ',year)) +
scale_fill_manual(values=c("#04bc3c", "#fc746c"))
ggsave(str_c("img/A/1/LegalForm/age/",form,".jpg"))
}
library(ggplot2)
library(stringr)
dfA2 <- dfAB[dfAB$status=='failed',]
dim(dfA2)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA2$year,dfA2$size), 1) , main=str_c('Failed "',form,'" by year'),
xlab="Size", legend = rownames(table(dfA2$year,dfA2$size)), beside=TRUE)
table(dfA2$year)
hist(dfA2$year, breaks = "Sturges",
freq = NULL)
hist(dfA2$year, breaks = 5"Sturges",
freq = T)
hist(dfA2$year, breaks = 5"Sturges",
freq = TRUE)
hist(dfA2$year, breaks = 5,
freq = TRUE)
hist(dfA2$year, breaks = c(2007,2013,2017),
freq = TRUE)
dfA2$y <- cut(dfA2$year, 3)
hist(dfA2$y, breaks = "Sturges"),
freq = TRUE)
hist(dfA2$y, breaks = "Sturges",
freq = TRUE)
hist
hist(dfA2$y)
hist(dfA2$y, breaks =  cut(dfA2$year, 3))
hist(dfA2$year, breaks =  cut(dfA2$year, 3))
cut(dfA2$year, 3)
table(dfA2$year)
table(dfA2$y)
dfA2$y <- cut2(dfA2$year, 3)
hist(dfA2$year, breaks =  cut(dfA2$year, 4))
dfA2$y <- cut2(dfA2$year, 4)
dfA2$y <- cut(dfA2$year, 4)
table(dfA2$y)
dfA2%y = 1
dfA2%y[dfA2$year>=2010] = 2
dfA2%y[dfA2$year>=2015] = 3
dfA2$y = 1
dfA2$y[dfA2$year>=2010] = 2
dfA2$y[dfA2$year>=2015] = 3
table(dfA2$y)
dfA2$y = 1
dfA2$y[dfA2$year>=2011] = 2
dfA2$y[dfA2$year>=2015] = 3
table(dfA2$y)
dfA2$y = "1990 - 2010"
dfA2$y[dfA2$year>=2011] = "2011-2014"
dfA2$y[dfA2$year>=2015] = "2015-2020"
table(dfA2$y)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA2$y,dfA2$size), 1) , main=str_c('Failed "',form,'" by year'),
xlab="Size", legend = rownames(table(dfA2$year,dfA2$size)), beside=TRUE)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA2$y,dfA2$size), 1) , main=str_c('Failed "',form,'" by year'),
xlab="Size", legend = rownames(table(dfA2$y,dfA2$size)), beside=TRUE)
dfA2$y = "1990 - 2010"
dfA2$y = "1990 - 2010"
dfA2$y[dfA2$year>=2010] = "x"
dfA2$y[dfA2$year>=2014] = "2011-2014"
dfA2$y[dfA2$year>=2017] = "2015-2020"
table(dfA2$y)
dfA2$y = "1990 - 2010"
dfA2$y[dfA2$year>=2010] = "x"
dfA2$y[dfA2$year>=2014] = "2011-2014"
dfA2$y[dfA2$year>=2016] = "2015-2020"
dfA2$y[dfA2$year>=2015] = "2015-2020"
table(dfA2$y)
dfA2$y[dfA2$year>=2016] = "2015-2020"
dfA2$y = "1990 - 2010"
dfA2$y[dfA2$year>=2011] = "2011-2014"
dfA2$y[dfA2$year>=2015] = "2015-2020"
table(dfA2$y)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA2$y,dfA2$size), 1) , main=str_c('Failed "',form,'" by year'),
xlab="Size", legend = rownames(table(dfA2$y,dfA2$size)), beside=TRUE)
library(ggplot2)
library(stringr)
dfA2 <- dfAB[dfAB$status=='failed',]
dim(dfA2)
hist(dfA2$year, breaks =  "sturges")
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA2$y,dfA2$size), 1) , main=str_c('Failed "',form,'" by year'),
xlab="Size", legend = rownames(table(dfA2$y,dfA2$size)), beside=TRUE)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA2$year,dfA2$size), 1) , main=str_c('Failed "',form,'" by year'),
xlab="Size", legend = rownames(table(dfA2$year,dfA2$size)), beside=TRUE)
barplot(prop.table(table(dfA2$year,dfA2$size), 1) , main=str_c('Failed "',form,'" by year'),
xlab="Size",  beside=TRUE)
dfA2$y = "1990 - 2010"
dfA2$y[dfA2$year>=2011] = "2011-2014"
dfA2$y[dfA2$year>=2015] = "2015-2020"
table(dfA2$y)
###################################
### SIZE GROUPED BARPLOT EXAPLE ###
###################################
barplot(prop.table(table(dfA2$y,dfA2$size), 1) , main=str_c('Failed "',form,'" by year'),
xlab="Size", legend = rownames(table(dfA2$y,dfA2$size)), beside=TRUE)
barplot(prop.table(table(dfA2$year,dfA2$size), 1) , main=str_c('Failed "',form,'" by year'),
xlab="Size",  beside=FALSE)
for (form in unique(dfA1$'Legal form')){
jpeg(str_c("img/A/2/LegalForm/size/",form,".jpg"))
df = dfA1[dfA1$`Legal form`==form,]
barplot(prop.table(table(df$y,df$size), 1) , main=str_c('Failed "',form,'" year by year'),
xlab="Size",
legend = rownames(table(df$y,df$size)), beside=TRUE)
dev.off()
}
dev.off()
for (form in unique(dfA1$'Legal form')){
jpeg(str_c("img/A/2/LegalForm/size/",form,".jpg"))
df = dfA2[dfA2$`Legal form`==form,]
barplot(prop.table(table(df$y,df$size), 1) , main=str_c('Failed "',form,'" year by year'),
xlab="Size",
legend = rownames(table(df$y,df$size)), beside=TRUE)
dev.off()
}
for (region in unique(dfA1$'Region')){
jpeg(str_c("img/A/2/Region/size/",region,".jpg"))
df = dfA2[dfA2$`Legal form`==form,]
barplot(prop.table(table(df$region,df$size), 1) , main=str_c('Failed company in "',region,'" year by year'),
xlab="Size",
legend = rownames(table(df$region,df$size)), beside=TRUE)
dev.off()
}
for (region in unique(dfA1$'region')){
jpeg(str_c("img/A/2/Region/size/",region,".jpg"))
df = dfA2[dfA2$`Legal form`==form,]
barplot(prop.table(table(df$region,df$size), 1) , main=str_c('Failed company in "',region,'" year by year'),
xlab="Size",
legend = rownames(table(df$region,df$size)), beside=TRUE)
dev.off()
}
table(dfA1$'region')
dfA2$'region'[dfA2$'region'=="Valle d'Aosta/Vallée d'Aoste ",] = "Valle d'Aosta"
dfA2$'region'[dfA2$'region'=="Valle d'Aosta/Vallée d'Aoste "] = "Valle d'Aosta"
dfA2$'region'[dfA2$'region'=="Valle d'Aosta/Vallée d'Aoste "] <- "Valle d'Aosta"
dfA2$'region'[dfA2$'region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
table(df$'region')
dfA2$'region'[dfA2$'region' == "Valle d'Aosta//Vallée d'Aoste"] <- "Valle d'Aosta"
dfA2$'region'[dfA2$'region' == "Campania"] <- "campania"
dfA2$'region'[dfA2$'region' == "Campania"] = "campania"
library(magrittr) # needs to be run every time you start R and want to use %>%
library(dplyr)
dfA2$'region'[dfA2$'region' == "Campania"] = "campania"
table(df$'region')
table(dfA2$'region')
dfA2 <- dfAB[dfAB$status=='failed',]
dim(dfA2)
table(dfA2$y)
dfA2$y = "1990 - 2010"
dfA2$y[dfA2$year>=2011] = "2011-2014"
dfA2$y[dfA2$year>=2015] = "2015-2020"
table(dfA2$'region')
dfA2$'region'[dfA2$'region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
table(dfA2$'region')
dfA2 <- dfAB[dfAB$status=='failed',]
dim(dfA2)
table(dfA2$'region')
class(df$region) = "String"
table(dfA2$'region')
dfA2$'region'[dfA2$'region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
dfA2 <- dfAB[dfAB$status=='failed',]
dim(dfA2)
class(df$region) = "Factor"
dfA2$'region'[dfA2$'region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
dfA2 <- dfAB[dfAB$status=='failed',]
dim(dfA2)
class(df$region) = "factor"
dfA2$'region'[dfA2$'region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
dfA2$'Region' = dfA2$'region'
dfA2$'Region'[dfA2$'region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
dfA2$Region <- as.factor(dfA2$region)
dfA2$'Region'[dfA2$'Region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
table(dfA2$'Region')
dfA2 <- dfAB[dfAB$status=='failed',]
dim(dfA2)
dfA2$Region <- as.character(dfA2$region)
dfA2$Region <- as.factor(dfA2$Region)
dfA2$'Region'[dfA2$'Region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
dfA2 <- dfAB[dfAB$status=='failed',]
dim(dfA2)
dfA2$region <- as.character(dfA2$region)
dfA2$region <- as.factor(dfA2$region)
dfA2$'region'[dfA2$'region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
lapply(dfA2, class)
class(df$region) = "character"
dfA2$'region'[dfA2$'region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
table(dfA2$'region')
dfA2 <- dfAB[dfAB$status=='failed',]
dim(dfA2)
lapply(dfA2, class)
class(df$region) = "character"
lapply(dfA2, class)
dfA2$region <- as.character(dfA2$region)
lapply(dfA2, class)
dfA2$'region'[dfA2$'region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
for (region in unique(dfA1$'region')){
jpeg(str_c("img/A/2/Region/size/",region,".jpg"))
df = dfA2[dfA2$`Legal form`==form,]
barplot(prop.table(table(df$region,df$size), 1) , main=str_c('Failed company in "',region,'" year by year'),
xlab="Size",
legend = rownames(table(df$region,df$size)), beside=TRUE)
dev.off()
}
dev.off()
dev.off()
for (region in unique(dfA2$'region')){
jpeg(str_c("img/A/2/Region/size/",region,".jpg"))
df = dfA2[dfA2$`Legal form`==form,]
barplot(prop.table(table(df$region,df$size), 1) , main=str_c('Failed company in "',region,'" year by year'),
xlab="Size",
legend = rownames(table(df$region,df$size)), beside=TRUE)
dev.off()
}
###################################
### AGE GROUPED BARPLOT EXAPLE ###
###################################
ggplot(dfA2, aes(x=age, fill=year)) + geom_density(alpha=0.4)
###################################
### AGE GROUPED BARPLOT EXAPLE ###
###################################
p <-ggplot(dfA2, aes(x=age, fill=year)) + geom_density(alpha=0.4)
p
for (region in unique(dfA2$'region')){
jpeg(str_c("img/A/2/Region/size/",region,".jpg"))
df = dfA2[dfA2$`region`==region,]
barplot(prop.table(table(df$y,df$size), 1) , main=str_c('Failed company in "',region,'" year by year'),
xlab="Size",
legend = rownames(table(df$y,df$size)), beside=TRUE)
dev.off()
}
dev.off()
dfA2 <- dfAB[dfAB$status=='failed',]
dim(dfA2)
dfA2$region <- as.character(dfA2$region)
dfA2$'region'[dfA2$'region' == "Valle d'Aosta/Vallée d'Aoste"] <- "Valle d'Aosta"
dfA2$y = "1990 - 2010"
dfA2$y[dfA2$year>=2011] = "2011-2014"
dfA2$y[dfA2$year>=2015] = "2015-2020"
table(dfA2$y)
for (region in unique(dfA2$'region')){
jpeg(str_c("img/A/2/Region/size/",region,".jpg"))
df = dfA2[dfA2$`region`==region,]
barplot(prop.table(table(df$y,df$size), 1) , main=str_c('Failed company in "',region,'" year by year'),
xlab="Size",
legend = rownames(table(df$y,df$size)), beside=TRUE)
dev.off()
}
###################################
### AGE GROUPED BARPLOT EXAPLE ###
###################################
p <-ggplot(dfA2, aes(x=age, fill=y)) + geom_density(alpha=0.4)
p
hist(dfA2$year, breaks =  "sturges")
table(dfA2$y)
hist(dfA2$year, breaks =  "sturges")
ggplot(dfA2, aes(x=age, fill=year)) + geom_density(alpha=0.4)
dfA2$yearchar <- as.character(dfA2year)
dfA2$yearchar <- as.character(dfA2$year)
ggplot(dfA2, aes(x=age, fill=yearchar)) + geom_density(alpha=0.4)
ggplot(dfA2[dfA2$year>2009,], aes(x=age, fill=yearchar)) + geom_density(alpha=0.4)
ggplot(dfA2[dfA2$year>2009 & dfA2$year<2019,], aes(x=age, fill=yearchar)) + geom_density(alpha=0.4)
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, fill=yearchar)) + geom_density(alpha=0.4)
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, fill=yearchar)) + geom_density(alpha=0)
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, fill=year)) + geom_density(alpha=0.9)
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, fill=year)) + geom_density(alpha=0.4)
dfA2$yearchar <- as.character(dfA2$year)
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, fill=yearchar)) + geom_density(alpha=0.4)
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, colours=yearchar)) + geom_density(alpha=0.4)
aes?
?aes
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, color=yearchar)) + geom_density(alpha=0.4)
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, color=yearchar)) + geom_density(size = 1.5)
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, color=yearchar)) + geom_density(size=1.5, alpha=0.4)
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, color=yearchar)) + geom_density(size=1, alpha=0.4)
for (form in unique(dfA2$'Legal form')){
df = dfA2[dfA2$`Legal form`==form,]
ggplot(dfA2, aes(x=age, fill=y)) + geom_density(alpha=0.4) +
ggtitle(str_c('Failed "',form,'" by period'))
ggsave(str_c("img/A/2/LegalForm/age/",form,"_period.jpg"))
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, color=yearchar)) + geom_density(size=1, alpha=0.4)+
ggtitle(str_c('Failed "',form,'"for last five years'))
ggsave(str_c("img/A/2/LegalForm/age/",form,"_last5.jpg"))
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(dfA2, aes(x=age, fill=y)) + geom_density(alpha=0.4) +
ggtitle(str_c('Failed company in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"))
ggplot(dfA2[dfA2$year>2013 & dfA2$year<2019,], aes(x=age, color=yearchar)) + geom_density(size=1, alpha=0.4)+
ggtitle(str_c('Failed company in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"))
}
