dfb$zone[dfb$`region`== "Calabria" ] <- "sud"
dfb$zone[dfb$`region`== "Basilicata" ] <- "sud"
dfb$zone[dfb$`region`== "Abruzzo" ] <- "sud"
dfb$zone[dfb$`region`== "Molise" ] <- "sud"
dfb$zone[dfb$`region`== "Campania" ] <- "sud"
dfb$zone[dfb$`region`== "Puglia" ] <- "sud"
dfb$zone[dfb$`region`== "Toscana" ] <- "centro"
dfb$zone[dfb$`region`== "Umbria" ] <- "centro"
dfb$zone[dfb$`region`== "Marche" ] <- "centro"
dfb$zone[dfb$`region`== "Lazio" ] <- "centro"
dfb$zone[dfb$`region`== "Trentino-Alto Adige" ] <- "nord est"
dfb$zone[dfb$`region`== "Veneto" ] <- "nord est"
dfb$zone[dfb$`region`== "Friuli-Venezia Giulia" ] <- "nord est"
dfb$zone[dfb$`region`== "Emilia-Romagna" ] <- "nord est"
dfb$zone[dfb$`region`== "Valle d'Aosta" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Lombardia" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Piemonte" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Liguria" ] <- "nord ovest"
return(dfb$zone)
}
dfb$zone = NaN
dfb$zone = getZones(dfb)
table(dfb$zone)
palette = brewer.pal(length(unique(dfb$zone)),"Dark2")
table(dfb$`ATECO10`)
View(dfb)
getAteco <- function(df){
df$`ateconames`[df$`ATECO10`== "01" ] <- "COLTIVAZIONI AGRICOLE E PRODUZIONE DI PRODOTTI ANIMALI, CACCIA E SERVIZI CONNESSI"
df$`ateconames`[df$`ATECO10`== "02" ] <-"SILVICOLTURA ED UTILIZZO DI AREE FORESTALI"
df$`ateconames`[df$`ATECO10`== "03" ] <-"PESCA E ACQUACOLTURA"
df$`ateconames`[df$`ATECO10`== "05" ] <-"ESTRAZIONE DI CARBONE (ESCLUSA TORBA)"
df$`ateconames`[df$`ATECO10`== "06" ] <-"ESTRAZIONE DI PETROLIO GREGGIO E DI GAS NATURALE"
df$`ateconames`[df$`ATECO10`== "07" ] <-"ESTRAZIONE DI MINERALI METALLIFERI"
df$`ateconames`[df$`ATECO10`== "08" ] <-"ALTRE ATTIVITÀ DI ESTRAZIONE DI MINERALI DA CAVE E MINIERE"
df$`ateconames`[df$`ATECO10`== "09" ] <-"ATTIVITÀ DEI SERVIZI DI SUPPORTO ALL'ESTRAZIONE"
df$`ateconames`[df$`ATECO10`== "10" ] <-"INDUSTRIE ALIMENTARI"
df$`ateconames`[df$`ATECO10`== "11" ] <-"INDUSTRIA DELLE BEVANDE"
df$`ateconames`[df$`ATECO10`== "13" ] <-"INDUSTRIE TESSILI"
df$`ateconames`[df$`ATECO10`== "14" ] <-"CONFEZIONE DI ARTICOLI DI ABBIGLIAMENTO; CONFEZIONE DI ARTICOLI IN PELLE E PELLICCIA"
df$`ateconames`[df$`ATECO10`== "15" ] <-"FABBRICAZIONE DI ARTICOLI IN PELLE E SIMILI"
df$`ateconames`[df$`ATECO10`== "16" ] <-"INDUSTRIA DEL LEGNO E DEI PRODOTTI IN LEGNO E SUGHERO (ESCLUSI I MOBILI); FABBRICAZIONE DI ARTICOLI IN PAGLIA E MATERIALI DA INTRECCIO"
df$`ateconames`[df$`ATECO10`== "17" ] <-"FABBRICAZIONE DI CARTA E DI PRODOTTI DI CARTA"
df$`ateconames`[df$`ATECO10`== "18" ] <-"STAMPA E RIPRODUZIONE DI SUPPORTI REGISTRATI"
df$`ateconames`[df$`ATECO10`== "19" ] <-"FABBRICAZIONE DI COKE E PRODOTTI DERIVANTI DALLA RAFFINAZIONE DEL PETROLIO"
df$`ateconames`[df$`ATECO10`== "20" ] <-"FABBRICAZIONE DI PRODOTTI CHIMICI"
df$`ateconames`[df$`ATECO10`== "21" ] <-"FABBRICAZIONE DI PRODOTTI FARMACEUTICI DI BASE E DI PREPARATI FARMACEUTICI"
df$`ateconames`[df$`ATECO10`== "22" ] <-"FABBRICAZIONE DI ARTICOLI IN GOMMA E MATERIE PLASTICHE"
df$`ateconames`[df$`ATECO10`== "23" ] <-"FABBRICAZIONE DI ALTRI PRODOTTI DELLA LAVORAZIONE DI MINERALI NON METALLIFERI"
df$`ateconames`[df$`ATECO10`== "24" ] <-"METALLURGIA"
df$`ateconames`[df$`ATECO10`== "25" ] <-"FABBRICAZIONE DI PRODOTTI IN METALLO (ESCLUSI MACCHINARI E ATTREZZATURE)"
df$`ateconames`[df$`ATECO10`== "26" ] <-"FABBRICAZIONE DI COMPUTER E PRODOTTI DI ELETTRONICA E OTTICA; APPARECCHI ELETTROMEDICALI, APPARECCHI DI MISURAZIONE E DI OROLOGI"
df$`ateconames`[df$`ATECO10`== "27" ] <-"FABBRICAZIONE DI APPARECCHIATURE ELETTRICHE ED APPARECCHIATURE PER USO DOMESTICO NON ELETTRICHE"
df$`ateconames`[df$`ATECO10`== "28" ] <-"FABBRICAZIONE DI MACCHINARI ED APPARECCHIATURE NCA"
df$`ateconames`[df$`ATECO10`== "29" ] <-"FABBRICAZIONE DI AUTOVEICOLI, RIMORCHI E SEMIRIMORCHI"
df$`ateconames`[df$`ATECO10`== "30" ] <-"FABBRICAZIONE DI ALTRI MEZZI DI TRASPORTO"
df$`ateconames`[df$`ATECO10`== "31" ] <-"FABBRICAZIONE DI MOBILI"
df$`ateconames`[df$`ATECO10`== "32" ] <-"ALTRE INDUSTRIE MANIFATTURIERE"
df$`ateconames`[df$`ATECO10`== "33" ] <-"RIPARAZIONE, MANUTENZIONE ED INSTALLAZIONE DI MACCHINE ED APPARECCHIATURE"
df$`ateconames`[df$`ATECO10`== "35" ] <-"FORNITURA DI ENERGIA ELETTRICA, GAS, VAPORE E ARIA CONDIZIONATA"
df$`ateconames`[df$`ATECO10`== "36" ] <-"RACCOLTA, TRATTAMENTO E FORNITURA DI ACQUA"
df$`ateconames`[df$`ATECO10`== "37" ] <-"GESTIONE DELLE RETI FOGNARIE"
df$`ateconames`[df$`ATECO10`== "38" ] <-"ATTIVITÀ DI RACCOLTA, TRATTAMENTO E SMALTIMENTO DEI RIFIUTI; RECUPERO DEI MATERIALI"
df$`ateconames`[df$`ATECO10`== "39" ] <-"ATTIVITÀ DI RISANAMENTO E ALTRI SERVIZI DI GESTIONE DEI RIFIUTI"
df$`ateconames`[df$`ATECO10`== "40" ] <-""
df$`ateconames`[df$`ATECO10`== "41" ] <-"COSTRUZIONE DI EDIFICI"
df$`ateconames`[df$`ATECO10`== "42" ] <-"INGEGNERIA CIVILE"
df$`ateconames`[df$`ATECO10`== "43" ] <-"LAVORI DI COSTRUZIONE SPECIALIZZATI"
df$`ateconames`[df$`ATECO10`== "45" ] <-"COMMERCIO ALL'INGROSSO E AL DETTAGLIO E RIPARAZIONE DI AUTOVEICOLI E MOTOCICLI"
df$`ateconames`[df$`ATECO10`== "46" ] <-"COMMERCIO ALL'INGROSSO (ESCLUSO QUELLO DI AUTOVEICOLI E DI MOTOCICLI)"
df$`ateconames`[df$`ATECO10`== "47" ] <-"COMMERCIO AL DETTAGLIO (ESCLUSO QUELLO DI AUTOVEICOLI E DI MOTOCICLI)"
df$`ateconames`[df$`ATECO10`== "49" ] <-"TRASPORTO TERRESTRE E TRASPORTO MEDIANTE CONDOTTE"
df$`ateconames`[df$`ATECO10`== "50" ] <-"TRASPORTO MARITTIMO E PER VIE D'ACQUA"
df$`ateconames`[df$`ATECO10`== "51" ] <-"TRASPORTO AEREO"
df$`ateconames`[df$`ATECO10`== "52" ] <-"MAGAZZINAGGIO E ATTIVITÀ DI SUPPORTO AI TRASPORTI"
df$`ateconames`[df$`ATECO10`== "53" ] <-"SERVIZI POSTALI E ATTIVITÀ DI CORRIERE"
df$`ateconames`[df$`ATECO10`== "54" ] <-""
df$`ateconames`[df$`ATECO10`== "55" ] <-"ALLOGGIO"
df$`ateconames`[df$`ATECO10`== "56" ] <-"ATTIVITÀ DEI SERVIZI DI RISTORAZIONE"
df$`ateconames`[df$`ATECO10`== "58" ] <-"ATTIVITÀ EDITORIALI"
df$`ateconames`[df$`ATECO10`== "59" ] <-"ATTIVITÀ DI PRODUZIONE CINEMATOGRAFICA, DI VIDEO E DI PROGRAMMI TELEVISIVI, DI REGISTRAZIONI MUSICALI E SONORE"
df$`ateconames`[df$`ATECO10`== "60" ] <-"ATTIVITÀ DI PROGRAMMAZIONE E TRASMISSIONE"
df$`ateconames`[df$`ATECO10`== "61" ] <-"TELECOMUNICAZIONI"
df$`ateconames`[df$`ATECO10`== "62" ] <-"PRODUZIONE DI SOFTWARE, CONSULENZA INFORMATICA E ATTIVITÀ CONNESSE"
df$`ateconames`[df$`ATECO10`== "63" ] <-"ATTIVITÀ DEI SERVIZI D'INFORMAZIONE E ALTRI SERVIZI INFORMATICI"
df$`ateconames`[df$`ATECO10`== "64" ] <-"ATTIVITÀ DI SERVIZI FINANZIARI (ESCLUSE LE ASSICURAZIONI E I FONDI PENSIONE)"
df$`ateconames`[df$`ATECO10`== "65" ] <-"ASSICURAZIONI, RIASSICURAZIONI E FONDI PENSIONE (ESCLUSE LE ASSICURAZIONI SOCIALI OBBLIGATORIE)"
df$`ateconames`[df$`ATECO10`== "66" ] <-"ATTIVITÀ AUSILIARIE DEI SERVIZI FINANZIARI E DELLE ATTIVITÀ ASSICURATIVE"
df$`ateconames`[df$`ATECO10`== "67" ] <-""
df$`ateconames`[df$`ATECO10`== "68" ] <-"ATTIVITÀ IMMOBILIARI"
df$`ateconames`[df$`ATECO10`== "69" ] <-"ATTIVITÀ LEGALI E CONTABILITÀ"
df$`ateconames`[df$`ATECO10`== "70" ] <-"ATTIVITÀ DI DIREZIONE AZIENDALE E DI CONSULENZA GESTIONALE"
df$`ateconames`[df$`ATECO10`== "71" ] <-"ATTIVITÀ DEGLI STUDI DI ARCHITETTURA E D'INGEGNERIA; COLLAUDI ED ANALISI TECNICHE"
df$`ateconames`[df$`ATECO10`== "72" ] <-"RICERCA SCIENTIFICA E SVILUPPO"
df$`ateconames`[df$`ATECO10`== "73" ] <-"PUBBLICITÀ E RICERCHE DI MERCATO"
df$`ateconames`[df$`ATECO10`== "74" ] <-"ALTRE ATTIVITÀ PROFESSIONALI, SCIENTIFICHE E TECNICHE"
df$`ateconames`[df$`ATECO10`== "75" ] <-"SERVIZI VETERINARI"
df$`ateconames`[df$`ATECO10`== "76" ] <-""
df$`ateconames`[df$`ATECO10`== "77" ] <-"ATTIVITÀ DI NOLEGGIO E LEASING OPERATIVO"
df$`ateconames`[df$`ATECO10`== "78" ] <-"ATTIVITÀ DI RICERCA, SELEZIONE, FORNITURA DI PERSONALE"
df$`ateconames`[df$`ATECO10`== "79" ] <-"ATTIVITÀ DEI SERVIZI DELLE AGENZIE DI VIAGGIO, DEI TOUR OPERATOR E SERVIZI DI PRENOTAZIONE E ATTIVITÀ CONNESSE"
df$`ateconames`[df$`ATECO10`== "80" ] <-"SERVIZI DI VIGILANZA E INVESTIGAZIONE"
df$`ateconames`[df$`ATECO10`== "81" ] <-"ATTIVITÀ DI SERVIZI PER EDIFICI E PAESAGGIO"
df$`ateconames`[df$`ATECO10`== "82" ] <-"ATTIVITÀ DI SUPPORTO PER LE FUNZIONI D'UFFICIO E ALTRI SERVIZI DI SUPPORTO ALLE IMPRESE"
df$`ateconames`[df$`ATECO10`== "83" ] <-"SERVIZI DI VIGILANZA E INVESTIGAZIONE"
df$`ateconames`[df$`ATECO10`== "84" ] <-"AMMINISTRAZIONE PUBBLICA E DIFESA; ASSICURAZIONE SOCIALE OBBLIGATORIA"
df$`ateconames`[df$`ATECO10`== "85" ] <-"ISTRUZIONE"
df$`ateconames`[df$`ATECO10`== "86" ] <-"ASSISTENZA SANITARIA"
df$`ateconames`[df$`ATECO10`== "87" ] <-"SERVIZI DI ASSISTENZA SOCIALE RESIDENZIALE"
df$`ateconames`[df$`ATECO10`== "88" ] <-"AASSISTENZA SOCIALE NON RESIDENZIALE"
df$`ateconames`[df$`ATECO10`== "89" ] <-"ATTIVITÀ CREATIVE, ARTISTICHE E DI INTRATTENIMENTO"
df$`ateconames`[df$`ATECO10`== "90" ] <-"ATTIVITÀ DI BIBLIOTECHE, ARCHIVI, MUSEI ED ALTRE ATTIVITÀ CULTURALI"
df$`ateconames`[df$`ATECO10`== "91" ] <-"ATTIVITÀ DI BIBLIOTECHE, ARCHIVI, MUSEI ED ALTRE ATTIVITÀ CULTURALI"
df$`ateconames`[df$`ATECO10`== "92" ] <-"ATTIVITÀ RIGUARDANTI LE LOTTERIE, LE SCOMMESSE, LE CASE DA GIOCO"
df$`ateconames`[df$`ATECO10`== "93" ] <-"ATTIVITÀ SPORTIVE, DI INTRATTENIMENTO E DI DIVERTIMENTO"
df$`ateconames`[df$`ATECO10`== "94" ] <-"ATTIVITÀ DI ORGANIZZAZIONI ASSOCIATIVE"
df$`ateconames`[df$`ATECO10`== "95" ] <-"RIPARAZIONE DI COMPUTER E DI BENI PER USO PERSONALE E PER LA CASA"
df$`ateconames`[df$`ATECO10`== "96" ] <-"ALTRE ATTIVITÀ DI SERVIZI PER LA PERSONA"
df$`ateconames`[df$`ATECO10`== "97" ] <-"ATTIVITÀ DI FAMIGLIE E CONVIVENZE COME DATORI DI LAVORO PER PERSONALE DOMESTICO"
df$`ateconames`[df$`ATECO10`== "98" ] <-"PRODUZIONE DI BENI E SERVIZI INDIFFERENZIATI PER USO PROPRIO DA PARTE DI FAMIGLIE E CONVIVENZE"
df$`ateconames`[df$`ATECO10`== "99" ] <-"ALTRE ATTIVITÀ DI SERVIZI PER LA PERSONA"
return (df$`ateconames`)
}
dfb$zone = NaN
dfb$zone = getZones(dfb)
table(dfb$zone)
getZones <- function(dfb) {
dfb$zone[dfb$`region`== "Sicilia" ] <- "isole"
dfb$zone[dfb$`region`== "Sardegna" ] <- "isole"
dfb$zone[dfb$`region`== "Calabria" ] <- "sud"
dfb$zone[dfb$`region`== "Basilicata" ] <- "sud"
dfb$zone[dfb$`region`== "Abruzzo" ] <- "sud"
dfb$zone[dfb$`region`== "Molise" ] <- "sud"
dfb$zone[dfb$`region`== "Campania" ] <- "sud"
dfb$zone[dfb$`region`== "Puglia" ] <- "sud"
dfb$zone[dfb$`region`== "Toscana" ] <- "centro"
dfb$zone[dfb$`region`== "Umbria" ] <- "centro"
dfb$zone[dfb$`region`== "Marche" ] <- "centro"
dfb$zone[dfb$`region`== "Lazio" ] <- "centro"
dfb$zone[dfb$`region`== "Trentino-Alto Adige" ] <- "nord est"
dfb$zone[dfb$`region`== "Veneto" ] <- "nord est"
dfb$zone[dfb$`region`== "Friuli-Venezia Giulia" ] <- "nord est"
dfb$zone[dfb$`region`== "Emilia-Romagna" ] <- "nord est"
dfb$zone[dfb$`region`== "Valle d'Aosta" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Lombardia" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Piemonte" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Liguria" ] <- "nord ovest"
return(dfb$zone)
}
getAteco <- function(df){
df$`ateconames`[df$`ATECO10`== "01" ] <- "COLTIVAZIONI AGRICOLE E PRODUZIONE DI PRODOTTI ANIMALI, CACCIA E SERVIZI CONNESSI"
df$`ateconames`[df$`ATECO10`== "02" ] <-"SILVICOLTURA ED UTILIZZO DI AREE FORESTALI"
df$`ateconames`[df$`ATECO10`== "03" ] <-"PESCA E ACQUACOLTURA"
df$`ateconames`[df$`ATECO10`== "05" ] <-"ESTRAZIONE DI CARBONE (ESCLUSA TORBA)"
df$`ateconames`[df$`ATECO10`== "06" ] <-"ESTRAZIONE DI PETROLIO GREGGIO E DI GAS NATURALE"
df$`ateconames`[df$`ATECO10`== "07" ] <-"ESTRAZIONE DI MINERALI METALLIFERI"
df$`ateconames`[df$`ATECO10`== "08" ] <-"ALTRE ATTIVITÀ DI ESTRAZIONE DI MINERALI DA CAVE E MINIERE"
df$`ateconames`[df$`ATECO10`== "09" ] <-"ATTIVITÀ DEI SERVIZI DI SUPPORTO ALL'ESTRAZIONE"
df$`ateconames`[df$`ATECO10`== "10" ] <-"INDUSTRIE ALIMENTARI"
df$`ateconames`[df$`ATECO10`== "11" ] <-"INDUSTRIA DELLE BEVANDE"
df$`ateconames`[df$`ATECO10`== "13" ] <-"INDUSTRIE TESSILI"
df$`ateconames`[df$`ATECO10`== "14" ] <-"CONFEZIONE DI ARTICOLI DI ABBIGLIAMENTO; CONFEZIONE DI ARTICOLI IN PELLE E PELLICCIA"
df$`ateconames`[df$`ATECO10`== "15" ] <-"FABBRICAZIONE DI ARTICOLI IN PELLE E SIMILI"
df$`ateconames`[df$`ATECO10`== "16" ] <-"INDUSTRIA DEL LEGNO E DEI PRODOTTI IN LEGNO E SUGHERO (ESCLUSI I MOBILI); FABBRICAZIONE DI ARTICOLI IN PAGLIA E MATERIALI DA INTRECCIO"
df$`ateconames`[df$`ATECO10`== "17" ] <-"FABBRICAZIONE DI CARTA E DI PRODOTTI DI CARTA"
df$`ateconames`[df$`ATECO10`== "18" ] <-"STAMPA E RIPRODUZIONE DI SUPPORTI REGISTRATI"
df$`ateconames`[df$`ATECO10`== "19" ] <-"FABBRICAZIONE DI COKE E PRODOTTI DERIVANTI DALLA RAFFINAZIONE DEL PETROLIO"
df$`ateconames`[df$`ATECO10`== "20" ] <-"FABBRICAZIONE DI PRODOTTI CHIMICI"
df$`ateconames`[df$`ATECO10`== "21" ] <-"FABBRICAZIONE DI PRODOTTI FARMACEUTICI DI BASE E DI PREPARATI FARMACEUTICI"
df$`ateconames`[df$`ATECO10`== "22" ] <-"FABBRICAZIONE DI ARTICOLI IN GOMMA E MATERIE PLASTICHE"
df$`ateconames`[df$`ATECO10`== "23" ] <-"FABBRICAZIONE DI ALTRI PRODOTTI DELLA LAVORAZIONE DI MINERALI NON METALLIFERI"
df$`ateconames`[df$`ATECO10`== "24" ] <-"METALLURGIA"
df$`ateconames`[df$`ATECO10`== "25" ] <-"FABBRICAZIONE DI PRODOTTI IN METALLO (ESCLUSI MACCHINARI E ATTREZZATURE)"
df$`ateconames`[df$`ATECO10`== "26" ] <-"FABBRICAZIONE DI COMPUTER E PRODOTTI DI ELETTRONICA E OTTICA; APPARECCHI ELETTROMEDICALI, APPARECCHI DI MISURAZIONE E DI OROLOGI"
df$`ateconames`[df$`ATECO10`== "27" ] <-"FABBRICAZIONE DI APPARECCHIATURE ELETTRICHE ED APPARECCHIATURE PER USO DOMESTICO NON ELETTRICHE"
df$`ateconames`[df$`ATECO10`== "28" ] <-"FABBRICAZIONE DI MACCHINARI ED APPARECCHIATURE NCA"
df$`ateconames`[df$`ATECO10`== "29" ] <-"FABBRICAZIONE DI AUTOVEICOLI, RIMORCHI E SEMIRIMORCHI"
df$`ateconames`[df$`ATECO10`== "30" ] <-"FABBRICAZIONE DI ALTRI MEZZI DI TRASPORTO"
df$`ateconames`[df$`ATECO10`== "31" ] <-"FABBRICAZIONE DI MOBILI"
df$`ateconames`[df$`ATECO10`== "32" ] <-"ALTRE INDUSTRIE MANIFATTURIERE"
df$`ateconames`[df$`ATECO10`== "33" ] <-"RIPARAZIONE, MANUTENZIONE ED INSTALLAZIONE DI MACCHINE ED APPARECCHIATURE"
df$`ateconames`[df$`ATECO10`== "35" ] <-"FORNITURA DI ENERGIA ELETTRICA, GAS, VAPORE E ARIA CONDIZIONATA"
df$`ateconames`[df$`ATECO10`== "36" ] <-"RACCOLTA, TRATTAMENTO E FORNITURA DI ACQUA"
df$`ateconames`[df$`ATECO10`== "37" ] <-"GESTIONE DELLE RETI FOGNARIE"
df$`ateconames`[df$`ATECO10`== "38" ] <-"ATTIVITÀ DI RACCOLTA, TRATTAMENTO E SMALTIMENTO DEI RIFIUTI; RECUPERO DEI MATERIALI"
df$`ateconames`[df$`ATECO10`== "39" ] <-"ATTIVITÀ DI RISANAMENTO E ALTRI SERVIZI DI GESTIONE DEI RIFIUTI"
df$`ateconames`[df$`ATECO10`== "40" ] <-""
df$`ateconames`[df$`ATECO10`== "41" ] <-"COSTRUZIONE DI EDIFICI"
df$`ateconames`[df$`ATECO10`== "42" ] <-"INGEGNERIA CIVILE"
df$`ateconames`[df$`ATECO10`== "43" ] <-"LAVORI DI COSTRUZIONE SPECIALIZZATI"
df$`ateconames`[df$`ATECO10`== "45" ] <-"COMMERCIO ALL'INGROSSO E AL DETTAGLIO E RIPARAZIONE DI AUTOVEICOLI E MOTOCICLI"
df$`ateconames`[df$`ATECO10`== "46" ] <-"COMMERCIO ALL'INGROSSO (ESCLUSO QUELLO DI AUTOVEICOLI E DI MOTOCICLI)"
df$`ateconames`[df$`ATECO10`== "47" ] <-"COMMERCIO AL DETTAGLIO (ESCLUSO QUELLO DI AUTOVEICOLI E DI MOTOCICLI)"
df$`ateconames`[df$`ATECO10`== "49" ] <-"TRASPORTO TERRESTRE E TRASPORTO MEDIANTE CONDOTTE"
df$`ateconames`[df$`ATECO10`== "50" ] <-"TRASPORTO MARITTIMO E PER VIE D'ACQUA"
df$`ateconames`[df$`ATECO10`== "51" ] <-"TRASPORTO AEREO"
df$`ateconames`[df$`ATECO10`== "52" ] <-"MAGAZZINAGGIO E ATTIVITÀ DI SUPPORTO AI TRASPORTI"
df$`ateconames`[df$`ATECO10`== "53" ] <-"SERVIZI POSTALI E ATTIVITÀ DI CORRIERE"
df$`ateconames`[df$`ATECO10`== "54" ] <-""
df$`ateconames`[df$`ATECO10`== "55" ] <-"ALLOGGIO"
df$`ateconames`[df$`ATECO10`== "56" ] <-"ATTIVITÀ DEI SERVIZI DI RISTORAZIONE"
df$`ateconames`[df$`ATECO10`== "58" ] <-"ATTIVITÀ EDITORIALI"
df$`ateconames`[df$`ATECO10`== "59" ] <-"ATTIVITÀ DI PRODUZIONE CINEMATOGRAFICA, DI VIDEO E DI PROGRAMMI TELEVISIVI, DI REGISTRAZIONI MUSICALI E SONORE"
df$`ateconames`[df$`ATECO10`== "60" ] <-"ATTIVITÀ DI PROGRAMMAZIONE E TRASMISSIONE"
df$`ateconames`[df$`ATECO10`== "61" ] <-"TELECOMUNICAZIONI"
df$`ateconames`[df$`ATECO10`== "62" ] <-"PRODUZIONE DI SOFTWARE, CONSULENZA INFORMATICA E ATTIVITÀ CONNESSE"
df$`ateconames`[df$`ATECO10`== "63" ] <-"ATTIVITÀ DEI SERVIZI D'INFORMAZIONE E ALTRI SERVIZI INFORMATICI"
df$`ateconames`[df$`ATECO10`== "64" ] <-"ATTIVITÀ DI SERVIZI FINANZIARI (ESCLUSE LE ASSICURAZIONI E I FONDI PENSIONE)"
df$`ateconames`[df$`ATECO10`== "65" ] <-"ASSICURAZIONI, RIASSICURAZIONI E FONDI PENSIONE (ESCLUSE LE ASSICURAZIONI SOCIALI OBBLIGATORIE)"
df$`ateconames`[df$`ATECO10`== "66" ] <-"ATTIVITÀ AUSILIARIE DEI SERVIZI FINANZIARI E DELLE ATTIVITÀ ASSICURATIVE"
df$`ateconames`[df$`ATECO10`== "67" ] <-""
df$`ateconames`[df$`ATECO10`== "68" ] <-"ATTIVITÀ IMMOBILIARI"
df$`ateconames`[df$`ATECO10`== "69" ] <-"ATTIVITÀ LEGALI E CONTABILITÀ"
df$`ateconames`[df$`ATECO10`== "70" ] <-"ATTIVITÀ DI DIREZIONE AZIENDALE E DI CONSULENZA GESTIONALE"
df$`ateconames`[df$`ATECO10`== "71" ] <-"ATTIVITÀ DEGLI STUDI DI ARCHITETTURA E D'INGEGNERIA; COLLAUDI ED ANALISI TECNICHE"
df$`ateconames`[df$`ATECO10`== "72" ] <-"RICERCA SCIENTIFICA E SVILUPPO"
df$`ateconames`[df$`ATECO10`== "73" ] <-"PUBBLICITÀ E RICERCHE DI MERCATO"
df$`ateconames`[df$`ATECO10`== "74" ] <-"ALTRE ATTIVITÀ PROFESSIONALI, SCIENTIFICHE E TECNICHE"
df$`ateconames`[df$`ATECO10`== "75" ] <-"SERVIZI VETERINARI"
df$`ateconames`[df$`ATECO10`== "76" ] <-""
df$`ateconames`[df$`ATECO10`== "77" ] <-"ATTIVITÀ DI NOLEGGIO E LEASING OPERATIVO"
df$`ateconames`[df$`ATECO10`== "78" ] <-"ATTIVITÀ DI RICERCA, SELEZIONE, FORNITURA DI PERSONALE"
df$`ateconames`[df$`ATECO10`== "79" ] <-"ATTIVITÀ DEI SERVIZI DELLE AGENZIE DI VIAGGIO, DEI TOUR OPERATOR E SERVIZI DI PRENOTAZIONE E ATTIVITÀ CONNESSE"
df$`ateconames`[df$`ATECO10`== "80" ] <-"SERVIZI DI VIGILANZA E INVESTIGAZIONE"
df$`ateconames`[df$`ATECO10`== "81" ] <-"ATTIVITÀ DI SERVIZI PER EDIFICI E PAESAGGIO"
df$`ateconames`[df$`ATECO10`== "82" ] <-"ATTIVITÀ DI SUPPORTO PER LE FUNZIONI D'UFFICIO E ALTRI SERVIZI DI SUPPORTO ALLE IMPRESE"
df$`ateconames`[df$`ATECO10`== "83" ] <-"SERVIZI DI VIGILANZA E INVESTIGAZIONE"
df$`ateconames`[df$`ATECO10`== "84" ] <-"AMMINISTRAZIONE PUBBLICA E DIFESA; ASSICURAZIONE SOCIALE OBBLIGATORIA"
df$`ateconames`[df$`ATECO10`== "85" ] <-"ISTRUZIONE"
df$`ateconames`[df$`ATECO10`== "86" ] <-"ASSISTENZA SANITARIA"
df$`ateconames`[df$`ATECO10`== "87" ] <-"SERVIZI DI ASSISTENZA SOCIALE RESIDENZIALE"
df$`ateconames`[df$`ATECO10`== "88" ] <-"AASSISTENZA SOCIALE NON RESIDENZIALE"
df$`ateconames`[df$`ATECO10`== "90" ] <-"ATTIVITÀ CREATIVE, ARTISTICHE E DI INTRATTENIMENTO"
df$`ateconames`[df$`ATECO10`== "91" ] <-"ATTIVITÀ DI BIBLIOTECHE, ARCHIVI, MUSEI ED ALTRE ATTIVITÀ CULTURALI"
df$`ateconames`[df$`ATECO10`== "92" ] <-"ATTIVITÀ RIGUARDANTI LE LOTTERIE, LE SCOMMESSE, LE CASE DA GIOCO"
df$`ateconames`[df$`ATECO10`== "93" ] <-"ATTIVITÀ SPORTIVE, DI INTRATTENIMENTO E DI DIVERTIMENTO"
df$`ateconames`[df$`ATECO10`== "94" ] <-"ATTIVITÀ DI ORGANIZZAZIONI ASSOCIATIVE"
df$`ateconames`[df$`ATECO10`== "95" ] <-"RIPARAZIONE DI COMPUTER E DI BENI PER USO PERSONALE E PER LA CASA"
df$`ateconames`[df$`ATECO10`== "96" ] <-"ALTRE ATTIVITÀ DI SERVIZI PER LA PERSONA"
df$`ateconames`[df$`ATECO10`== "97" ] <-"ATTIVITÀ DI FAMIGLIE E CONVIVENZE COME DATORI DI LAVORO PER PERSONALE DOMESTICO"
df$`ateconames`[df$`ATECO10`== "98" ] <-"PRODUZIONE DI BENI E SERVIZI INDIFFERENZIATI PER USO PROPRIO DA PARTE DI FAMIGLIE E CONVIVENZE"
df$`ateconames`[df$`ATECO10`== "99" ] <-"ALTRE ATTIVITÀ DI SERVIZI PER LA PERSONA"
return (df$`ateconames`)
}
dfb$ateconames = NaN
dfb$ateconames = getAteco(dfb)
table(dfb$ateconames)
legend ?
#################################
############ ATECO  #############
dfb$ateconames = NaN
legend?
#################################
############ ATECO  #############
dfb$ateconames = NaN
?legend
palette = brewer.pal(length(unique(dfb$zone)),"Dark2")
barplot(prop.table(table(dfb$`zone`,dfb$size), 1) , main='Failed in 2018 by zone',
xlab="Size",col=palette,  beside=TRUE)
legend(1, 95, col=palette,legend=c(dfb$`zone`))
barplot(prop.table(table(dfb$`zone`,dfb$size), 1) , main='Failed in 2018 by zone',
xlab="Size",col=palette,  beside=TRUE)
legend(20,  col=palette,legend=c(dfb$`zone`))
barplot(prop.table(table(dfb$`zone`,dfb$size), 1) , main='Failed in 2018 by zone',
xlab="Size",col=palette,  beside=TRUE)
legend(20,  col=palette,legend=c(unique(dfb$`zone`)),cex = 0.8)
legend(20, 1, col=palette,legend=c(unique(dfb$`zone`)),cex = 0.8)
barplot(prop.table(table(dfb$`zone`,dfb$size), 1) , main='Failed in 2018 by zone',
xlab="Size",col=palette,  beside=TRUE)
legend(10, 1, col=palette,legend=c(unique(dfb$`zone`)),cex = 0.8)
?legend
barplot(prop.table(table(dfb$`zone`,dfb$size), 1) , main='Failed in 2018 by zone',
xlab="Size",col=palette,  beside=TRUE)
legend(10, 1, fill=palette,legend=c(unique(dfb$`zone`)),cex = 0.8)
barplot(prop.table(table(dfb$`zone`,dfb$size), 1) , main='Failed in 2018 by zone',
xlab="Size",col=palette,  beside=TRUE)
legend(15, 0.5, fill=palette,legend=c(unique(dfb$`zone`)),cex = 0.8)
barplot(prop.table(table(dfb$`zone`,dfb$size), 1) , main='Failed in 2018 by zone',
xlab="Size",col=palette,  beside=TRUE)
legend(15, 0.9, fill=palette,legend=c(unique(dfb$`zone`)),cex = 0.8)
barplot(prop.table(table(dfb$`zone`,dfb$size), 1) , main='Failed in 2018 by zone',
xlab="Size",col=palette,  beside=TRUE)
legend(15, 0.95, text.font=0.5,fill=palette,legend=c(unique(dfb$`zone`)),cex = 0.8)
for (zone in unique(dfb$zone)){
jpeg(str_c("img/B/Region/",zone,".jpg"))
df = dfb[dfb$zone == zone,]
palette = brewer.pal(length(unique(df$region)),"Dark2")
barplot(prop.table(table(df$region,df$size), 1) , main=str_c('Failed company in "',zone,'" in 2018'),
xlab="Size", col = palette,
legend = rownames(table(df$region,df$size)), beside=TRUE)
dev.off()
}
for (zone in unique(dfb$zone)){
jpeg(str_c("img/B/Region/",zone,".jpg"))
df = dfb[dfb$zone == zone,]
n = length(unique(df$region))
if (n < 3){n = 3}
palette = brewer.pal(n,"Dark2")
barplot(prop.table(table(df$region,df$size), 1) , main=str_c('Failed company in "',zone,'" in 2018'),
xlab="Size", col = palette,
legend = rownames(table(df$region,df$size)), beside=TRUE)
dev.off()
}
palette = brewer.pal(length(unique(dfb$zone)),"Dark2")
ggplot(dfb, aes(x=age, color=zone, legend=FALSE)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  zone of Italy'))
ggplot(dfb, aes(x=age, color=zone, legend=FALSE)) + geom_density(size=0.5, col=palette, alpha=0.4)+
ggtitle(str_c('Failed companies by  zone of Italy'))
palette = brewer.pal(length(unique(dfb$zone)),"Dark2")
ggplot(dfb, aes(x=age, color=zone, legend=FALSE, col=palette)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  zone of Italy'))
ggplot(dfb, aes(x=age, color=zone, legend=FALSE)) + geom_density(size=0.5, alpha=0.4, col=palette)+
ggtitle(str_c('Failed companies by  zone of Italy'))
for (zone in unique(dfb$zone)){
df = dfb[dfb$zone == zone,]
ggplot(df, aes(x=age, fill=region)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',zone,'" in 2018'))
ggsave(str_c("img/B/Region/age",zone,".jpg"),dpi=300)
}
for (zone in unique(dfb$zone)){
df = dfb[dfb$zone == zone,]
ggplot(df, aes(x=age, fill=region)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',zone,'" in 2018'))
ggsave(str_c("img/B/Region/age/",zone,".jpg"),dpi=300)
}
par(mfrow=c(5,4))
for (ateco in unique(dfb$ATECO)){
# jpeg(str_c("img/B/ATECO/",zone,".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
palette = brewer.pal(n,"Dark2")
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = palette,
legend = rownames(table(df$region,df$size)), beside=TRUE)
# dev.off()
}
par(mfrow=c(4,5))
for (ateco in unique(dfb$ATECO)){
# jpeg(str_c("img/B/ATECO/",zone,".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
palette = brewer.pal(n,"Dark2")
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = palette,
legend = rownames(table(df$region,df$size)), beside=TRUE)
# dev.off()
}
graphics.off()# par("mar") par(mar=c(1,1,1,1))
for (ateco in unique(dfb$ATECO)){
# jpeg(str_c("img/B/ATECO/",zone,".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
palette = brewer.pal(n,"Dark2")
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = palette,
legend = rownames(table(df$region,df$size)), beside=TRUE)
# dev.off()
}
for (ateco in unique(dfb$ATECO)){
# jpeg(str_c("img/B/ATECO/",zone,".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
palette = brewer.pal(n,"Dark2")
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = palette,
legend = rownames(table(df$ATECO10,df$size)), beside=TRUE)
# dev.off()
}
colors = c( "#FFFF00", "#1CE6FF", "#FF34FF", "#FF4A46", "#008941", "#006FA6", "#A30059",
"#FFDBE5", "#7A4900", "#0000A6", "#63FFAC", "#B79762", "#004D43", "#8FB0FF", "#997D87",
"#5A0007")
for (ateco in unique(dfb$ATECO)){
# jpeg(str_c("img/B/ATECO/",zone,".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
if (n<8){
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors,legend = rownames(table(df$ATECO10,df$size)) ,beside=TRUE)
}
else{
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors,legend = rownames(table(df$ATECO10,df$size)) ,beside=TRUE)
legend(15, 0.95, text.font=0.5,ncol=2,fill=colors,legend = rownames(table(df$ATECO10,df$size)),cex = 0.8)
}
#dev.off()
}
for (ateco in unique(dfb$ATECO)){
# jpeg(str_c("img/B/ATECO/",zone,".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
if (n<8){
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors,legend = rownames(table(df$ATECO10,df$size)) ,beside=TRUE)
}
else{
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors ,beside=TRUE)
legend(25, 1, text.font=0.5,ncol=3,fill=colors,legend = rownames(table(df$ATECO10,df$size)),cex = 0.8)
}
#dev.off()
}
for (ateco in unique(dfb$ATECO)){
# jpeg(str_c("img/B/ATECO/",zone,".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
if (n<8){
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors,legend = rownames(table(df$ATECO10,df$size)) ,beside=TRUE)
}
else{
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors ,beside=TRUE)
legend(35, 1, text.font=0.5,ncol=3,fill=colors,legend = rownames(table(df$ATECO10,df$size)),cex = 0.8)
}
#dev.off()
}
for (ateco in unique(dfb$ATECO)){
# jpeg(str_c("img/B/ATECO/",zone,".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
if (n<8){
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors,legend = rownames(table(df$ATECO10,df$size)) ,beside=TRUE)
}
else{
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors ,beside=TRUE)
legend(45, 1, text.font=0.5,ncol=3,fill=colors,legend = rownames(table(df$ATECO10,df$size)),cex = 0.8)
}
#dev.off()
}
for (ateco in unique(dfb$ATECO)){
# jpeg(str_c("img/B/ATECO/",zone,".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
if (n<8){
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors,legend = rownames(table(df$ATECO10,df$size)) ,beside=TRUE)
}
else{
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors ,beside=TRUE)
legend(65, 1, text.font=0.5,ncol=3,fill=colors,legend = rownames(table(df$ATECO10,df$size)),cex = 0.8)
}
#dev.off()
}
names(df)
names(aida)
View(aida)
colors = c("#023fa5", "#7d87b9", "#bec1d4", "#d6bcc0", "#bb7784", "#8e063b", "#4a6fe3", "#8595e1", "#b5bbe3", "#e6afb9", "#e07b91", "#d33f6a", "#11c638", "#8dd593", "#c6dec7", "#ead3c6", "#f0b98d", "#ef9708", "#0fcfc0", "#9cded6", "#d5eae7", "#f3e1eb", "#f6c4e1", "#f79cd4")
for (ateco in unique(dfb$ATECO)){
jpeg(str_c("img/B/ATECO/size/",ateco,".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
if (n<8){
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors,legend = rownames(table(df$ATECO10,df$size)) ,beside=TRUE)
}
else{
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors ,beside=TRUE)
legend(65, 1, text.font=0.5,ncol=3,fill=colors,legend = rownames(table(df$ATECO10,df$size)),cex = 0.8)
}
dev.off()
}
for (ateco in unique(dfb$ATECO)){
jpeg(str_c("img/B/ATECO/size/",str_sub(ateco, 1, 3),".jpg"))
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
if (n < 3){n = 3}
if (n<8){
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors,legend = rownames(table(df$ATECO10,df$size)) ,beside=TRUE)
}
else{
barplot(prop.table(table(df$ATECO10,df$size), 1) , main=str_c('Failed company of  "',ateco,'" in 2018'),
xlab="Size", col = colors ,beside=TRUE)
legend(65, 1, text.font=0.5,ncol=3,fill=colors,legend = rownames(table(df$ATECO10,df$size)),cex = 0.8)
}
dev.off()
}
for (ateco in unique(dfb$ATECO)){
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
ggplot(df, aes(x=age, fill=ATECO10)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies of "',ateco,'" in 2018'))
ggsave(str_c("img/B/ATECO/age/",ateco,".jpg"),dpi=300)
}
for (ateco in unique(dfb$ATECO)){
df = dfb[dfb$ATECO == ateco,]
n = length(unique(df$ATECO10))
ggplot(df, aes(x=age, fill=ATECO10)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies of "',ateco,'" in 2018'))
ggsave(str_c("img/B/ATECO/age/",str_sub(ateco, 1, 3),".jpg"),dpi=300)
}
names(aida)
names(aida)
ggplot(aida, aes(x="Cash Flowth EURLast avail. yr", fill="Legal Form")) + geom_density(alpha=0.4)
dim(dfAB)
df = aida
summary(df)
library(ggplot2)
library(stringr)
