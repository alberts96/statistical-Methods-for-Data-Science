xlab="Size",col='c', breaks =  "sturges")
library(RColorBrewer)
par(mar=c(3,4,2,2))
display.brewer.all()
colors =
display.brewer.pal(7,"BrBG")
hist(dfA2$year,  main=str_c('Failed year by year'),
xlab="Size",col=brewer.pal("GnBu"), breaks =  "sturges")
hist(dfA2$year,  main=str_c('Failed year by year'),
xlab="Size",col=brewer.pal(21,"GnBu"), breaks =  "sturges")
hist(dfA2$year,  main=str_c('Failed year by year'),
xlab="Size",col="#03ab84", breaks =  "sturges")
hist(dfA2$year,  main=str_c('Failed campnies by year'),
xlab="Size",col="#03ab84", breaks =  "sturges")
dfA2$period = "1990 - 2010"
dfA2$period[dfA2$year>=2011] = "2011-2014"
dfA2$period[dfA2$year>=2015] = "2015-2020"
table(dfA2$period)
for (form in unique(dfA2$'Legal form')){
jpeg(str_c("img/A/2/LegalForm/size/",form,".jpg"))
df = dfA2[dfA2$`Legal form`==form,]
barplot(prop.table(table(df$period,df$size), 1) , main=str_c('Failed "',form,'" by period'),
xlab="Size",
legend = rownames(table(df$period,df$size)), beside=TRUE)
dev.off()
}
##APPLY THIS IN A FOR LOOP FOR ALL LEGAL FORMS
palette = brewer.pal(3,"Reds")
for (form in unique(dfA2$'Legal form')){
jpeg(str_c("img/A/2/LegalForm/size/",form,".jpg"))
df = dfA2[dfA2$`Legal form`==form,]
barplot(prop.table(table(df$period,df$size), 1) , main=str_c('Failed "',form,'" by period'),
xlab="Size", col = palette,
legend = rownames(table(df$period,df$size)), beside=TRUE)
dev.off()
}
palette = brewer.pal(3,"Oranges")
for (region in unique(dfA2$'region')){
jpeg(str_c("img/A/2/Region/size/",region,".jpg"))
df = dfA2[dfA2$`region`==region,]
barplot(prop.table(table(df$y,df$size), 1) , main=str_c('Failed company in "',region,'" by period'),
xlab="Size", col = palette,
legend = rownames(table(df$y,df$size)), beside=TRUE)
dev.off()
}
###################################
### AGE GROUPED BARPLOT EXAPLE ###
###################################
ggplot(dfA2, aes(x=age, fill=y)) + geom_density(alpha=0.4)
###################################
### AGE GROUPED BARPLOT EXAPLE ###
###################################
ggplot(dfA2, aes(x=age, fill=period)) + geom_density(alpha=0.4)
###################################
### AGE GROUPED BARPLOT EXAPLE ###
###################################
dfA2$y = dfA2$year
dfA2$year <- as.character(dfA2$year)
ggplot(dfA2, aes(x=age, fill=period)) + geom_density(alpha=0.4)
ggplot(dfA2[dfA2$y>2013 & dfA2$y<2019,], aes(x=age, color=year)) + geom_density(size=1, alpha=0.4)
palette3 = brewer.pal(3,"Reds")
palette5 = brewer.pal(5,"Reds")
palette3 = brewer.pal(3,"Reds")
palette5 = brewer.pal(5,"Reds")
ggplot(dfA2, aes(x=age, fill=period, col=palette3)) + geom_density(alpha=0.4)
ggplot(dfA2, aes(x=age, fill=period)) + geom_density(alpha=0.4) +
scale_fill_brewer(palette="Reds") +
ggplot(dfA2[dfA2$y>2013 & dfA2$y<2019,], aes(x=age, color=year)) + geom_density(size=1, alpha=0.4)
ggplot(dfA2, aes(x=age, fill=period)) + geom_density(alpha=0.4) +
scale_fill_brewer(palette="Reds")
ggplot(dfA2, aes(x=age, fill=period)) + geom_density(alpha=0.4) +
scale_fill_brewer(palette="Set3")
ggplot(dfA2, aes(x=age, fill=period)) + geom_density(alpha=0.4) +
scale_fill_brewer(palette="Set1")
ggplot(dfA2, aes(x=age, fill=period)) + geom_density(alpha=0.4) +
scale_color_brewer(palette="Set1")
for (form in unique(dfA2$'Legal form')){
df = dfA2[dfA2$`Legal form`==form,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.4) +
ggtitle(str_c('Failed "',form,'" by period'))
ggsave(str_c("img/A/2/LegalForm/age/",form,"_period.jpg"))
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=1, alpha=0.4)+
ggtitle(str_c('Failed "',form,'" in the last five years'))
ggsave(str_c("img/A/2/LegalForm/age/",form,"_last5.jpg"))
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.4) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"))
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=1, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"))
}
for (form in unique(dfA2$'Legal form')){
df = dfA2[dfA2$`Legal form`==form,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.3) +
ggtitle(str_c('Failed "',form,'" by period'))
ggsave(str_c("img/A/2/LegalForm/age/",form,"_period.jpg"))
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.7, alpha=0.4)+
ggtitle(str_c('Failed "',form,'" in the last five years'))
ggsave(str_c("img/A/2/LegalForm/age/",form,"_last5.jpg"))
}
for (form in unique(dfA2$'Legal form')){
df = dfA2[dfA2$`Legal form`==form,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed "',form,'" by period'))
ggsave(str_c("img/A/2/LegalForm/age/",form,"_period.jpg"))
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed "',form,'" in the last five years'))
ggsave(str_c("img/A/2/LegalForm/age/",form,"_last5.jpg"))
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df,height=900, width=1600, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"))
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"))
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"),height=900, width=1600)
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),height=900, width=1600)
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"),height=900, width=1600,limitsize=FALSE)
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),height=900, width=1600,limitsize=FALSE)
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"),height=450, width=800)
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),height=450, width=800)
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"),height=450, width=800,limitsize=FALSE)
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),height=450, width=800,limitsize=FALSE)
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"),height=600, width=800,limitsize=FALSE)
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),height=600, width=800,limitsize=FALSE)
}
dev.off()
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"),height=600, width=800,limitsize=FALSE)
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),height=600, width=800,limitsize=FALSE)
}
dev.off()
dev.off()
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"),height=600, width=800)
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),height=600, width=800)
}
dev.off()
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"),height=600, width=800,limitsize=FALSE)
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),height=600, width=800,limitsize=FALSE)
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"))
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),height=300, width=400,limitsize=FALSE)
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"))
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),dpi=300)
}
for (form in unique(dfA2$'Legal form')){
df = dfA2[dfA2$`Legal form`==form,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed "',form,'" by period'))
ggsave(str_c("img/A/2/LegalForm/age/",form,"_period.jpg"),dpi=300)
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed "',form,'" in the last five years'))
ggsave(str_c("img/A/2/LegalForm/age/",form,"_last5.jpg"),dpi=300)
}
for (region in unique(dfA2$region)){
df = dfA2[dfA2$region==region,]
ggplot(df, aes(x=age, fill=period)) + geom_density(alpha=0.2) +
ggtitle(str_c('Failed companies in "',region,'" by period'))
ggsave(str_c("img/A/2/Region/age/",region,"_period.jpg"),dpi=300)
ggplot(df[df$y>2013 & df$y<2019,], aes(x=age, color=year)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies in "',region,'" in the last five years'))
ggsave(str_c("img/A/2/Region/age/",region,"_last5.jpg"),dpi=300)
}
dfb <- dfAB[dfAB$status=='failed',]
dfb$region <- as.character(dfb$region)
dfb$'region'[dfb$'region' == "Valle d'Aosta/VallÃ©e d'Aoste"] <- "Valle d'Aosta"
year = 2018 #2018 is the most populet year
dfb <- dfb[dfb$year==year,]
dim(dfb)
dfb$`Legal form`[dfb$`Legal form` == "S.N.C." | dfb$`Legal form` == "S.A.S." | dfb$`Legal form` == "Social cooperative company"] = "Other"
getZones <- function(x) {
df$`zone`[df$`region`== "Sicilia" ] <- "isole"
df$`zone`[df$`region`== "Sardegna" ] <- "isole"
df$`zone`[df$`region`== "Calabria" ] <- "sud"
df$`zone`[df$`region`== "Basilicata" ] <- "sud"
df$`zone`[df$`region`== "Abruzzo" ] <- "sud"
df$`zone`[df$`region`== "Molise" ] <- "sud"
df$`zone`[df$`region`== "Campania" ] <- "sud"
df$`zone`[df$`region`== "Puglia" ] <- "sud"
df$`zone`[df$`region`== "Toscana" ] <- "centro"
df$`zone`[df$`region`== "Umbria" ] <- "centro"
df$`zone`[df$`region`== "Marche" ] <- "centro"
df$`zone`[df$`region`== "Lazio" ] <- "centro"
df$`zone`[df$`region`== "Trentino-Alto Adige" ] <- "nord est"
df$`zone`[df$`region`== "Veneto" ] <- "nord est"
df$`zone`[df$`region`== "Friuli-Venezia Giulia" ] <- "nord est"
df$`zone`[df$`region`== "Emilia-Romagna" ] <- "nord est"
df$`zone`[df$`region`== "Valle d'Aosta/Vall\xe9e d'Aoste" ] <- "nord ovest"
df$`zone`[df$`region`== "Lombardia" ] <- "nord ovest"
df$`zone`[df$`region`== "Piemonte" ] <- "nord ovest"
df$`zone`[df$`region`== "Liguria" ] <- "nord ovest"
}
getZones <- function(df) {
df$`zone`[df$`region`== "Sicilia" ] <- "isole"
df$`zone`[df$`region`== "Sardegna" ] <- "isole"
df$`zone`[df$`region`== "Calabria" ] <- "sud"
df$`zone`[df$`region`== "Basilicata" ] <- "sud"
df$`zone`[df$`region`== "Abruzzo" ] <- "sud"
df$`zone`[df$`region`== "Molise" ] <- "sud"
df$`zone`[df$`region`== "Campania" ] <- "sud"
df$`zone`[df$`region`== "Puglia" ] <- "sud"
df$`zone`[df$`region`== "Toscana" ] <- "centro"
df$`zone`[df$`region`== "Umbria" ] <- "centro"
df$`zone`[df$`region`== "Marche" ] <- "centro"
df$`zone`[df$`region`== "Lazio" ] <- "centro"
df$`zone`[df$`region`== "Trentino-Alto Adige" ] <- "nord est"
df$`zone`[df$`region`== "Veneto" ] <- "nord est"
df$`zone`[df$`region`== "Friuli-Venezia Giulia" ] <- "nord est"
df$`zone`[df$`region`== "Emilia-Romagna" ] <- "nord est"
df$`zone`[df$`region`== "Valle d'Aosta/Vall\xe9e d'Aoste" ] <- "nord ovest"
df$`zone`[df$`region`== "Lombardia" ] <- "nord ovest"
df$`zone`[df$`region`== "Piemonte" ] <- "nord ovest"
df$`zone`[df$`region`== "Liguria" ] <- "nord ovest"
}
getZones(dfb)
table(dfb$zone)
getZones <- function(df) {
df$.zone[df$`region`== "Sicilia" ] <- "isole"
df$.zone[df$`region`== "Sardegna" ] <- "isole"
df$.zone[df$`region`== "Calabria" ] <- "sud"
df$.zone[df$`region`== "Basilicata" ] <- "sud"
df$.zone[df$`region`== "Abruzzo" ] <- "sud"
df$.zone[df$`region`== "Molise" ] <- "sud"
df$.zone[df$`region`== "Campania" ] <- "sud"
df$.zone[df$`region`== "Puglia" ] <- "sud"
df$.zone[df$`region`== "Toscana" ] <- "centro"
df$.zone[df$`region`== "Umbria" ] <- "centro"
df$.zone[df$`region`== "Marche" ] <- "centro"
df$.zone[df$`region`== "Lazio" ] <- "centro"
df$.zone[df$`region`== "Trentino-Alto Adige" ] <- "nord est"
df$.zone[df$`region`== "Veneto" ] <- "nord est"
df$.zone[df$`region`== "Friuli-Venezia Giulia" ] <- "nord est"
df$.zone[df$`region`== "Emilia-Romagna" ] <- "nord est"
df$.zone[df$`region`== "Valle d'Aosta/Vall\xe9e d'Aoste" ] <- "nord ovest"
df$.zone[df$`region`== "Lombardia" ] <- "nord ovest"
df$.zone[df$`region`== "Piemonte" ] <- "nord ovest"
df$.zone[df$`region`== "Liguria" ] <- "nord ovest"
}
getZones(dfb)
dfb.zone = NaN
getZones(dfb)
table(dfb$zone)
getZones <- function(dfb) {
dfb$.zone[dfb$`region`== "Sicilia" ] <- "isole"
dfb$.zone[dfb$`region`== "Sardegna" ] <- "isole"
dfb$.zone[dfb$`region`== "Calabria" ] <- "sud"
dfb$.zone[dfb$`region`== "Basilicata" ] <- "sud"
dfb$.zone[dfb$`region`== "Abruzzo" ] <- "sud"
dfb$.zone[dfb$`region`== "Molise" ] <- "sud"
dfb$.zone[dfb$`region`== "Campania" ] <- "sud"
dfb$.zone[dfb$`region`== "Puglia" ] <- "sud"
dfb$.zone[dfb$`region`== "Toscana" ] <- "centro"
dfb$.zone[dfb$`region`== "Umbria" ] <- "centro"
dfb$.zone[dfb$`region`== "Marche" ] <- "centro"
dfb$.zone[dfb$`region`== "Lazio" ] <- "centro"
dfb$.zone[dfb$`region`== "Trentino-Alto Adige" ] <- "nord est"
dfb$.zone[dfb$`region`== "Veneto" ] <- "nord est"
dfb$.zone[dfb$`region`== "Friuli-Venezia Giulia" ] <- "nord est"
dfb$.zone[dfb$`region`== "Emilia-Romagna" ] <- "nord est"
dfb$.zone[dfb$`region`== "Valle d'Aosta/Vall\xe9e d'Aoste" ] <- "nord ovest"
dfb$.zone[dfb$`region`== "Lombardia" ] <- "nord ovest"
dfb$.zone[dfb$`region`== "Piemonte" ] <- "nord ovest"
dfb$.zone[dfb$`region`== "Liguria" ] <- "nord ovest"
}
dfb.zone = NaN
getZones(dfb)
table(dfb$zone)
getZones <- function(dfb) {
dfb$zone[dfb$`region`== "Sicilia" ] <- "isole"
dfb$zone[dfb$`region`== "Sardegna" ] <- "isole"
dfb$zone[dfb$`region`== "Calabria" ] <- "sud"
dfb$zone[dfb$`region`== "Basilicata" ] <- "sud"
dfb$zone[dfb$`region`== "Abruzzo" ] <- "sud"
dfb$zone[dfb$`region`== "Molise" ] <- "sud"
dfb$zone[dfb$`region`== "Campania" ] <- "sud"
dfb$zone[dfb$`region`== "Puglia" ] <- "sud"
dfb$zone[dfb$`region`== "Toscana" ] <- "centro"
dfb$zone[dfb$`region`== "Umbria" ] <- "centro"
dfb$zone[dfb$`region`== "Marche" ] <- "centro"
dfb$zone[dfb$`region`== "Lazio" ] <- "centro"
dfb$zone[dfb$`region`== "Trentino-Alto Adige" ] <- "nord est"
dfb$zone[dfb$`region`== "Veneto" ] <- "nord est"
dfb$zone[dfb$`region`== "Friuli-Venezia Giulia" ] <- "nord est"
dfb$zone[dfb$`region`== "Emilia-Romagna" ] <- "nord est"
dfb$zone[dfb$`region`== "Valle d'Aosta/Vall\xe9e d'Aoste" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Lombardia" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Piemonte" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Liguria" ] <- "nord ovest"
}
dfb$zone = NaN
getZones(dfb)
table(dfb$zone)
table(dfb$zone)
getZones(dfb)
getZones <- function(dfb) {
dfb$zone[dfb$`region`== "Sicilia" ] <- "isole"
dfb$zone[dfb$`region`== "Sardegna" ] <- "isole"
dfb$zone[dfb$`region`== "Calabria" ] <- "sud"
dfb$zone[dfb$`region`== "Basilicata" ] <- "sud"
dfb$zone[dfb$`region`== "Abruzzo" ] <- "sud"
dfb$zone[dfb$`region`== "Molise" ] <- "sud"
dfb$zone[dfb$`region`== "Campania" ] <- "sud"
dfb$zone[dfb$`region`== "Puglia" ] <- "sud"
dfb$zone[dfb$`region`== "Toscana" ] <- "centro"
dfb$zone[dfb$`region`== "Umbria" ] <- "centro"
dfb$zone[dfb$`region`== "Marche" ] <- "centro"
dfb$zone[dfb$`region`== "Lazio" ] <- "centro"
dfb$zone[dfb$`region`== "Trentino-Alto Adige" ] <- "nord est"
dfb$zone[dfb$`region`== "Veneto" ] <- "nord est"
dfb$zone[dfb$`region`== "Friuli-Venezia Giulia" ] <- "nord est"
dfb$zone[dfb$`region`== "Emilia-Romagna" ] <- "nord est"
dfb$zone[dfb$`region`== "Valle d'Aosta" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Lombardia" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Piemonte" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Liguria" ] <- "nord ovest"
}
dfb$zone = NaN
getZones(dfb)
table(dfb$zone)
dfb$zone = NaN
getZones(dfb)
table(dfb$zone)
dfb -> getZones()
dfb -> getZones
table(dfb$zone)
getZones <- function(dfb) {
dfb$zone[dfb$`region`== "Sicilia" ] <- "isole"
dfb$zone[dfb$`region`== "Sardegna" ] <- "isole"
dfb$zone[dfb$`region`== "Calabria" ] <- "sud"
dfb$zone[dfb$`region`== "Basilicata" ] <- "sud"
dfb$zone[dfb$`region`== "Abruzzo" ] <- "sud"
dfb$zone[dfb$`region`== "Molise" ] <- "sud"
dfb$zone[dfb$`region`== "Campania" ] <- "sud"
dfb$zone[dfb$`region`== "Puglia" ] <- "sud"
dfb$zone[dfb$`region`== "Toscana" ] <- "centro"
dfb$zone[dfb$`region`== "Umbria" ] <- "centro"
dfb$zone[dfb$`region`== "Marche" ] <- "centro"
dfb$zone[dfb$`region`== "Lazio" ] <- "centro"
dfb$zone[dfb$`region`== "Trentino-Alto Adige" ] <- "nord est"
dfb$zone[dfb$`region`== "Veneto" ] <- "nord est"
dfb$zone[dfb$`region`== "Friuli-Venezia Giulia" ] <- "nord est"
dfb$zone[dfb$`region`== "Emilia-Romagna" ] <- "nord est"
dfb$zone[dfb$`region`== "Valle d'Aosta" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Lombardia" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Piemonte" ] <- "nord ovest"
dfb$zone[dfb$`region`== "Liguria" ] <- "nord ovest"
return(dfb$zone)
}
dfb$zone = getZones(dfb)
table(dfb$zone)
barplot(prop.table(table(dfb$`Legal form`,dfb$size), 1) , main='Failed by year and legal form',
xlab="Size",col=colors,  beside=TRUE)
table(dfb$`Legal form`)
dfb$`legalform` = dfb$`Legal form`
table(dfb$`legalform`)
dfb$legalform = NaN
table(dfb$`legalform`)
dfb$`legalform` = c(dfb$`Legal form`)
table(dfb$`legalform`)
unique(dfb$legalform)
unique(dfb$`Legal form`)
dfb$`legalform` = c(lg for lg in unique(dfb$`Legal form`))
dfb$`legalform` = c(for lf in unique(dfb$`Legal form`) lf)
dfb$`legalform` = c(for (lf in unique(dfb$`Legal form`))lf)
table(dfb$`legalform`)
dfb$`legalform` = c(for (lf in unique(dfb$`Legal form`))lf)
dfb$`legalform` = c(for (lf in dfb$`Legal form`)lf)
table(dfb$`legalform`)
dfb$legalform = NaN
table(dfb$`legalform`)
length(unique(dfb$`Legal form`))
dfb$`legalform` = c(for (lf in dfb$`Legal form`)lf)
for (lf in unique(dfb$`Legal form`) {
for (lf in unique(dfb$`Legal form`)){
dfb$`legalform`[dfb$`Legal form` == lf] = lf
}
dfb$legalform = NaN
for (lf in unique(dfb$`Legal form`)){
dfb$`legalform`[dfb$`Legal form` == lf] = lf
}
table(dfb$`legalform`)
barplot(prop.table(table(dfb$`legalform`,dfb$size), 1) , main='Failed by year and legal form',
xlab="Size",col=colors,  beside=TRUE)
barplot(prop.table(table(dfb$`legalform`,dfb$size), 1) , main='Failed by year and legal form',
xlab="Size",col=brewer.pal(8,"Dark2"),  beside=TRUE)
legend(1, 95, col=brewer.pal(8,"Dark2"),legend=c(dfb$`Legal form`),
lty=1:2, cex=0.8)
barplot(prop.table(table(dfb$`legalform`,dfb$size), 1) , main='Failed by year and legal form',
xlab="Size",col=brewer.pal(8,"Dark2"),legend=TRUE,  beside=TRUE)
barplot(prop.table(table(dfb$`legalform`,dfb$size), 1) , main='Failed by year and legal form',
xlab="",col=brewer.pal(8,"Dark2"),legend=TRUE,  beside=TRUE)
barplot(prop.table(table(dfb$`legalform`,dfb$size), 1) , main='Failed by year and legal form',
xlab="Size",col=brewer.pal(8,"Dark2"),  beside=TRUE)
table(dfb$`legalform`)
ggplot(dfb, aes(x=age, color=`legalform`)) + geom_density(size=0.8, alpha=0.4)
ggplot(dfb, aes(x=age, color=legalform)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form'))
ggplot(dfb, aes(x=age, color=legalform)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) + scale_fill_brewer('Dark2')
ggplot(dfb, aes(x=age, color=legalform)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) + scale_color_brewer('Dark2')
ggplot(dfb, aes(x=age, color=legalform)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) +
scale_color_brewer(palette='Dark2')
ggplot(dfb, aes(x=age, color=legalform)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) +
scale_color_brewer(palette='Dark2') +
ggsave("img/B/Region/age/legalform by age.jpg",dpi=300)
ggplot(dfb, aes(x=age, color=legalform)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) +
scale_color_brewer(palette='Dark2') +
ggsave("img/B/Region/age/legalform by age.jpg",dpi=100)
ggplot(dfb, aes(x=age, color=legalform, legend=FALSE)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) +
scale_color_brewer(palette='Dark2') +
ggsave("img/B/Region/age/legalform by age.jpg",dpi=100)
ggplot(dfb, aes(x=age, color=legalform, legend=FALSE)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) +
scale_color_brewer(palette='Dark2')
ggplot(dfb, aes(x=age, color=legalform, legend=FALSE)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) +
scale_color_brewer(palette='Dark2') +
ggsave("img/B/Region/age/legalform by age.jpg",sizelimit=FALSE,dpi=300)
ggplot(dfb, aes(x=age, color=legalform, legend=FALSE)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) +
scale_color_brewer(palette='Dark2') +
ggsave("img/B/Region/age/legalform by age.jpg",sizelimit=FALSE)
ggplot(dfb, aes(x=age, color=legalform, legend=FALSE)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) +
scale_color_brewer(palette='Dark2') +
ggsave("img/B/Region/age/legalform by age.jpg")
dev.off()
ggplot(dfb, aes(x=age, color=legalform, legend=FALSE)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) +
scale_color_brewer(palette='Dark2') +
ggsave("img/B/Region/age/legalform by age.jpg")
dev.off()
ggplot(dfb, aes(x=age, color=legalform, legend=FALSE)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form')) +
scale_color_brewer(palette='Dark2')
ggplot(dfb, aes(x=age, color=legalform, legend=FALSE)) + geom_density(size=0.5, alpha=0.4)+
ggtitle(str_c('Failed companies by  legal form'))
